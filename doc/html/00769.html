<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>USB_DEVICE_HID_ReportSend Function</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', '00769.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="00300.html" target="topic">USB Libraries Help</a> &gt; <a href="00207.html" target="topic">USB Device Libraries</a> &gt; <a href="00236.html" target="topic">USB HID Device Library</a> &gt; <a href="00263.html" target="topic">Library Interface</a> &gt; a) Functions &gt; <a href="00769.html" target="topic">USB_DEVICE_HID_ReportSend Function</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony USB Stack </div>
</td><td width="25%">
<div class="Element2">
<a href="contents.html" target="tocidx">Contents</a> | <a href="00181.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="00768.html" target="topic">Previous</a> | <a href="00263.html" target="topic">Up</a> | <a href="00779.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: USB_DEVICE_HID_ReportSend@USB_DEVICE_HID_INDEX@USB_DEVICE_HID_TRANSFER_HANDLE *@void *@size_t Topic Title: USB_DEVICE_HID_ReportSend Function)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table><div class="Element5">
USB_DEVICE_HID_ReportSend Function</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
This function places a request to send a HID report with the USB Device HID Function Driver Layer. The function places a requests with driver, the request will get serviced when report is requested by the USB Host. A handle to the request is returned in the transferHandle parameter. The termination of the request is indicated by the USB_DEVICE_HID_EVENT_REPORT_SENT event. The amount of data sent, a pointer to the report and the transfer handle associated with the request is returned along with the event in the pData parameter of the event handler. The transfer handle expires when event handler for the USB_DEVICE_HID_EVENT_REPORT_SENT exits. If the send request could not be accepted, the function returns an error code and transferHandle will contain the value <a href="00778.html" target="topic">USB_DEVICE_HID_TRANSFER_HANDLE_INVALID</a>.</p></div>
</div>
<a name="43"></a><div class="Element99">
C</div>
<div class="Element101"><div class="Element100"><pre class="Element100"><a href="00770.html" target="topic">USB_DEVICE_HID_RESULT</a> <strong><span style="color: #000000">USB_DEVICE_HID_ReportSend</span></strong>(
    <a href="00754.html" target="topic">USB_DEVICE_HID_INDEX</a> <strong><span style="color: #000000">instanceIndex</span></strong>, 
    <a href="00777.html" target="topic">USB_DEVICE_HID_TRANSFER_HANDLE</a> * <strong><span style="color: #000000">handle</span></strong>, 
    <strong><span style="color: #000080">void</span></strong> * <strong><span style="color: #000000">buffer</span></strong>, 
    size_t <strong><span style="color: #000000">size</span></strong>
);</pre></div></div>
<a name="507265636F6E646974696F6E73"></a><div class="Element14">
Preconditions</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
USB device layer must be initialized.</p></div>
</div>
<a name="506172616D6574657273"></a><div class="Element14">
Parameters</div>
<div class="Element11">
<div class="Element10">
<div class="Element312">
<div class="TableDiv">
<table cellspacing="0" class="Table3">
<tr>
<td class="Element300" valign="top" width="35%">
<div class="Element301">
Parameters&nbsp;</div></td><td class="Element304" valign="top" width="65%">
<div class="Element305">
Description&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
instance&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
USB Device HID Function Driver instance.<br>&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
transferHandle&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
Pointer to a <a href="00777.html" target="topic">USB_DEVICE_HID_TRANSFER_HANDLE</a> type of variable. This variable will contain the transfer handle in case the send request was successful.<br>&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
data&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
pointer to the data buffer containing the report to be sent.<br>&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
size&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
Size (in bytes) of the report to be sent.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
<a name="52657475726E73"></a><div class="Element14">
Returns</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
USB_DEVICE_HID_RESULT_OK - The send request was successful. transferHandle contains a valid transfer handle.&nbsp;</p>
<p class="Element10">
USB_DEVICE_HID_RESULT_ERROR_TRANSFER_QUEUE_FULL - Internal request queue is full. The send request could not be added.&nbsp;</p>
<p class="Element10">
USB_DEVICE_HID_RESULT_ERROR_INSTANCE_NOT_CONFIGURED - The specified instance is not configured yet.&nbsp;</p>
<p class="Element10">
USB_DEVICE_HID_RESULT_ERROR_INSTANCE_INVALID - The specified instance was not provisioned in the application and is invalid.</p></div>
</div>
<a name="52656D61726B73"></a><div class="Element14">
Remarks</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
While the using the HID Function Driver with the PIC32MZ USB module, the report data buffer provided to the USB_DEVICE_HID_ReportSend function should be placed in coherent memory and aligned at a 16 byte boundary. This can be done by declaring the buffer using the __attribute__((coherent, aligned(16))) attribute. An example is shown here&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element13"><div class="Element12"><pre class="Element12">uint8_t data[256] __attribute__((coherent, aligned(16)));</pre></div></div>
</div>
</div>
<a name="4578616D706C65"></a><div class="Element14">
Example</div>
<div class="Element11">
<div class="Element10">
<div class="Element13"><div class="Element12"><pre class="Element12"><a href="00777.html" target="topic">USB_DEVICE_HID_TRANSFER_HANDLE</a> hidTransferHandle;
<a href="00770.html" target="topic">USB_DEVICE_HID_RESULT</a> result;

<i><span style="color: #008000">// Register APP_HIDEventHandler function</span></i>
<a href="00752.html" target="topic">USB_DEVICE_HID_EventHandlerSet</a>( <a href="00755.html" target="topic">USB_DEVICE_HID_INDEX_0</a> ,
                                APP_HIDEventHandler );

<i><span style="color: #008000">// Prepare report and request HID to send the report.</span></i>
result = USB_DEVICE_HID_ReportSend( <a href="00755.html" target="topic">USB_DEVICE_HID_INDEX_0</a>,
                           &amp;hidTransferHandle ,
                           &amp;appReport[0], <strong><span style="color: #000080">sizeof</span></strong>(appReport));

<strong><span style="color: #000080">if</span></strong>( result != USB_DEVICE_HID_RESULT_OK)
{
   <i><span style="color: #008000">//Handle error.</span></i>

}

<i><span style="color: #008000">//Implementation of APP_HIDEventHandler</span></i>

USB_DEVICE_HIDE_EVENT_RESPONSE APP_HIDEventHandler
{
    <a href="00754.html" target="topic">USB_DEVICE_HID_INDEX</a> instanceIndex,
    <a href="00714.html" target="topic">USB_DEVICE_HID_EVENT</a> event,
    <strong><span style="color: #000080">void</span></strong> * pData,
    uintptr_t context
}
{
    <a href="00736.html" target="topic">USB_DEVICE_HID_EVENT_DATA_REPORT_SENT</a> * reportSentEventData;

    <i><span style="color: #008000">// Handle HID events here.</span></i>
    <strong><span style="color: #000080">switch</span></strong> (event)
    {
        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_HID_EVENT_REPORT_SENT:
            
            reportSentEventData = (USB_DEVICE_HID_EVENT_REPORT_SENT *)pData;
            <strong><span style="color: #000080">if</span></strong>(reportSentEventData-&gt;reportSize == <strong><span style="color: #000080">sizeof</span></strong>(appReport))
            {
                <i><span style="color: #008000">// The report was sent completely.</span></i>
            }
            <strong><span style="color: #000080">break</span></strong>;

            ....

    }
    <strong><span style="color: #000080">return</span></strong>(<a href="00751.html" target="topic">USB_DEVICE_HID_EVENT_RESPONSE_NONE</a>);
}
</pre></div></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="00300.html" target="topic">USB Libraries Help</a> &gt; <a href="00207.html" target="topic">USB Device Libraries</a> &gt; <a href="00236.html" target="topic">USB HID Device Library</a> &gt; <a href="00263.html" target="topic">Library Interface</a> &gt; a) Functions &gt; <a href="00769.html" target="topic">USB_DEVICE_HID_ReportSend Function</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element3">
MPLAB Harmony USB Stack </div>
</td><td width="25%">
<div class="Element4">
<a href="contents.html" target="tocidx">Contents</a> | <a href="00181.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element91">
<a href="00768.html" target="topic">Previous</a> | <a href="00263.html" target="topic">Up</a> | <a href="00779.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: USB_DEVICE_HID_ReportSend@USB_DEVICE_HID_INDEX@USB_DEVICE_HID_TRANSFER_HANDLE *@void *@size_t Topic Title: USB_DEVICE_HID_ReportSend Function)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>