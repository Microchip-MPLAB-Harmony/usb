<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Event Handling</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="00290.html">USB Libraries Help</a> &gt; <a href="00197.html">USB Device Libraries</a> &gt; <a href="00195.html">USB CDC Device Library</a> &gt; <a href="00194.html">Using the Library</a> &gt; <a href="00187.html">How the Library Works</a> &gt; <a href="00184.html">Event Handling</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony USB Stack </div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="00171.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="00190.html">Previous</a> | <a href="00187.html">Up</a> | <a href="00193.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: USB DEVCDC Event Handling Topic Title: Event Handling)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
Event Handling</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<div class="Element15">
Registering a CDC Function Driver Event Handler</div>
<p class="Element10">
While creating USB CDC Device-based application, an event handler must be registered with the Device Layer (the Device Layer Event Handler) and every CDC Function Driver instance (CDC Function Driver Event Handler). The CDC Function Driver event handler receives CDC and CDC ACM events. This event handler should be registered before the USB device<span style="color: #FFFFFF">_</span>layer acknowledges the SET CONFIGURATION request from the USB Host. To ensure this, the event handler should be set in the USB_DEVICE_EVENT_CONFIGURED event that is generated by the device<span style="color: #FFFFFF">_</span>layer. While registering the CDC Function Driver event handler, the CDC Function Driver allows the application to also pass a data object in the event handler register function. This data object gets associated with the instance of the CDC Function Driver and is returned by the CDC Function Driver when a CDC Function Driver event occurs. The following code shows an example of how this can be done. </p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00018');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00018"><pre class="Element12"><i><span style="color: #008000">/* This a sample Application Device Layer Event Handler
 * Note how the CDC Function Driver event handler APP_USBDeviceCDCEventHandler()
 * is registered in the USB_DEVICE_EVENT_CONFIGURED event. The appData
 * object that is passed in the USB_DEVICE_CDC_EventHandlerSet()
 * function will be returned as the userData parameter in the
 * when the APP_USBDeviceCDCEventHandler() function is invoked */</span></i>

<strong><span style="color: #000080">void</span></strong> APP_USBDeviceEventCallBack ( USB_DEVICE_EVENT event,
     <strong><span style="color: #000080">void</span></strong> * eventData, uintptr_t context )
{
     <strong><span style="color: #000080">switch</span></strong> ( event )
     {
        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_RESET:
        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_DECONFIGURED:

             <i><span style="color: #008000">// USB device is reset or device is deconfigured.</span></i>
             <i><span style="color: #008000">// This means that USB device layer is about to deinitialize</span></i>
             <i><span style="color: #008000">// all function drivers.</span></i>

             <strong><span style="color: #000080">break</span></strong>;

        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_CONFIGURED:

            <i><span style="color: #008000">/* check the configuration */</span></i>
            <strong><span style="color: #000080">if</span></strong> ( *((uint8_t *)eventData) == 1)
            {

                <i><span style="color: #008000">/* Register the CDC Device application event handler here.
                 * Note how the appData object pointer is passed as the
                 * user data */</span></i>

                USB_DEVICE_CDC_EventHandlerSet(USB_DEVICE_CDC_INDEX_0,
                      APP_USBDeviceCDCEventHandler, (uintptr_t)&amp;appData);

                <i><span style="color: #008000">/* mark that set configuration is complete */</span></i>
                appData.isConfigured = <strong><span style="color: #000080">true</span></strong>;
            }
            <strong><span style="color: #000080">break</span></strong>;

        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_SUSPENDED:

            <strong><span style="color: #000080">break</span></strong>;

        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_RESUMED:
        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_ATTACHED:
        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_DETACHED:
        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_ERROR:
        <strong><span style="color: #000080">default</span></strong>:
            <strong><span style="color: #000080">break</span></strong>;
     }
}</pre></div></div>
<p class="Element10">
The CDC Function Driver event handler executes in an interrupt context when the device stack is configured for Interrupt mode. In Polled mode, the event handler is invoked in the context of the SYS_Tasks function. The application should not call computationally intensive functions, blocking functions, functions that are not interrupt safe, or functions that poll on hardware conditions from the event handler. Doing so will affect the ability of the USB device stack to respond to USB events and could potentially make the USB device non-compliant.</p><div class="Element15">
CDC Function Driver Events</div>
<p class="Element10">
The CDC Function Driver generates events to which the application must respond. Some of these events are management requests communicated through control transfers. Therefore, the application must use the Device Layer Control Transfer routines to complete the control transfer. Based on the generated event, the application may be required to:</p>
<ul class="Element630">
<li class="Element600">Respond with a USB_DEVICE_ControlSend function, which is completes the data stage of a Control Read Transfer</li>
<li class="Element600">Respond with a USB_DEVICE_ControlReceive function, which provisions the data stage of a Control Write Transfer</li>
<li class="Element600">Respond with a USB_DEVICE_ControlStatus function, which completes the handshake stage of the Control Transfer. The application can either STALL or Acknowledge the handshake stage via the USB_DEVICE_ControlStatus function. The following table shows the CDC Function Driver Control Transfer related events and the required application control transfer actions.</li>
</ul><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table1">
<tr>
<td class="Element65" valign="top" width="39%">
<div class="Element66">
CDC Function Driver Control Transfer Event&nbsp;</div></td><td class="Element65" valign="top" width="61%">
<div class="Element66">
Required Application Action&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="39%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_SET_LINE_CODING&nbsp;</div></td><td class="Element67" valign="top" width="61%">
<div class="Element68">
Call USB_DEVICE_ControlReceive function with a buffer to receive the USB_CDC_LINE_CODING type data.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="39%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_SET_LINE_CODING&nbsp;</div></td><td class="Element67" valign="top" width="61%">
<div class="Element68">
Call USB_DEVICE_ControlSend function with a buffer that contains the current USB_CDC_LINE_CODING type data.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="39%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_SET_CONTROL_LINE_STATE&nbsp;</div></td><td class="Element67" valign="top" width="61%">
<div class="Element68">
Acknowledge or stall using the USB_DEVICE_ControlStatus function.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="39%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_SET_CONTROL_LINE_STATE&nbsp;</div></td><td class="Element67" valign="top" width="61%">
<div class="Element68">
Acknowledge or stall using the USB_DEVICE_ControlStatus function.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="39%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_SENT&nbsp;</div></td><td class="Element67" valign="top" width="61%">
<div class="Element68">
Action not required.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="39%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_RECEIVED&nbsp;</div></td><td class="Element67" valign="top" width="61%">
<div class="Element68">
Acknowledge or stall using the USB_DEVICE_ControlStatus function.&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
Based on the type of event, the application should analyze the pData member of the event handler. This data member should be type cast to an event specific data type. The following table shows the event and the data type to use while type casting. Note that the pData member is not required for all events </p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table1">
<tr>
<td class="Element65" valign="top" width="61%">
<div class="Element66">
CDC Function Driver Event&nbsp;</div></td><td class="Element65" valign="top" width="39%">
<div class="Element66">
Related pData type&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="61%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_SET_LINE_CODING&nbsp;</div></td><td class="Element67" valign="top" width="39%">
<div class="Element68">
NULL&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="61%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_GET_LINE_CODING&nbsp;</div></td><td class="Element67" valign="top" width="39%">
<div class="Element68">
NULL&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="61%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_SET_CONTROL_LINE_STATE&nbsp;</div></td><td class="Element67" valign="top" width="39%">
<div class="Element68">
USB_CDC_CONTROL_LINE_STATE *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="61%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_SEND_BREAK&nbsp;</div></td><td class="Element67" valign="top" width="39%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_DATA_SEND_BREAK *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="61%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_WRITE_COMPLETE&nbsp;</div></td><td class="Element67" valign="top" width="39%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_DATA_WRITE_COMPLETE *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="61%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_READ_COMPLETE&nbsp;</div></td><td class="Element67" valign="top" width="39%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_DATA_READ_COMPLETE *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="61%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_SERIAL_STATE_NOTIFICATION_COMPLETE&nbsp;</div></td><td class="Element67" valign="top" width="39%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_DATA_SERIAL_STATE_NOTIFICATION_COMPLETE *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="61%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_SENT&nbsp;</div></td><td class="Element67" valign="top" width="39%">
<div class="Element68">
NULL&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="61%">
<div class="Element68">
USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_RECEIVED&nbsp;</div></td><td class="Element67" valign="top" width="39%">
<div class="Element68">
NULL&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
The possible CDC Function Driver events are described here with the required application response, event specific data, and likely follow-up function driver event:</p><div class="Element15">
USB_DEVICE_CDC_EVENT_SET_LINE_CODING</div>
<p class="Element10">
<i>Application Response</i><strong>:</strong> This event occurs when the host issues a SET LINE CODING command. The application must provide a USB_CDC_LINE_CODING data structure to the device<span style="color: #FFFFFF">_</span>layer to receive the line coding data that the host will provide. The application must provide the buffer by calling the USB_DEVICE_CDC_ControlReceive function either in the event handler or in the application after returning from the event handler. The application can use the USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_SENT event to track completion of the command.&nbsp;</p>
<p class="Element10">
<i>Event Specific Data (pData</i>): The pData parameter will be NULL.&nbsp;</p>
<p class="Element10">
<i>Likely Follow-up event</i><strong>: </strong>This event will likely be followed by the USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_RECEIVED event. This indicates that the data was received successfully. The application must either acknowledge or stall the handshake stage of the control transfer by calling the USB_DEVICE_ControlStatus function with the USB_DEVICE_CONTROL_STATUS_OK or USB_DEVICE_CONTROL_STATUS_ERROR flag, respectively.&nbsp;</p><div class="Element15">
USB_DEVICE_CDC_EVENT_GET_LINE_CODING</div>
<p class="Element10">
<i>Application Response</i>: This event occurs when the host issues a GET LINE CODING command. The application must provide a USB_CDC_LINE_CODING data structure to the device<span style="color: #FFFFFF">_</span>layer that contains the line coding data to be provided to the Host. The application must provide the buffer by calling the USB_DEVICE_ControlSend function either in the event handler or in the application after returning from the event handler. The size of the buffer is indicated by the length parameter. The application can use the USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_SENT event to track completion of the command.&nbsp;</p>
<p class="Element10">
<i>Event Specific Data (pData)</i>: The pData parameter will be NULL.&nbsp;</p>
<p class="Element10">
<i>Likely Follow-up event</i><strong>: </strong>This event will likely be followed by the USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_SENT event. This indicates that the data was sent to the Host successfully.&nbsp;</p><div class="Element15">
USB_DEVICE_CDC_EVENT_SET_CONTROL_LINE_STATE</div>
<p class="Element10">
<i>Application Response</i>: This event occurs when the host issues a SET CONTROL LINE STATE command. The application can then use the USB_DEVICE_ControlStatus function to indicate acceptance of rejection of the command. The USB_DEVICE_ControlStatus function can be called from the event handler or in the application after returning from the event handler.&nbsp;</p>
<p class="Element10">
<i>Event Specific Data (pData)</i>: The application must interpret the pData parameter as a pointer to a USB_CDC_CONTROL_LINE_STATE data type that contains the control line state data.&nbsp;</p>
<p class="Element10">
<i>Likely Follow-up event</i><strong>: </strong>None.&nbsp;</p><div class="Element15">
USB_DEVICE_CDC_EVENT_SEND_BREAK</div>
<p class="Element10">
<i>Application Response</i>: This event occurs when the Host issues a SEND BREAK command. The application can then use the USB_DEVICE_ControlStatus function to indicate acceptance or rejection of the command. The USB_DEVICE_ControlStatus function can be called from the event handler or in the application after returning from the event handler.&nbsp;</p>
<p class="Element10">
<i>Event Specific Data (pData)</i>: The application must interpret the pData parameter as a pointer to a uint16_t data type that contains the break duration data.&nbsp;</p>
<p class="Element10">
<i>Likely Follow-up event</i><strong>: </strong>None.&nbsp;</p><div class="Element15">
USB_DEVICE_CDC_EVENT_WRITE_COMPLETE</div>
<p class="Element10">
<i>Application Response</i><strong>: </strong>This event occurs when a write operation scheduled by calling the USB_DEVICE_CDC_Write function has completed. This event does not require the application to respond with any function calls.&nbsp;</p>
<p class="Element10">
<i>Event Specific Data (pData)</i><strong>: </strong>The pData member in the event handler will point to the USB_DEVICE_CDC_EVENT_DATA_WRITE_COMPLETE data type.&nbsp;</p>
<p class="Element10">
<i>Likely Follow-up event</i><strong>: </strong>None.&nbsp;</p><div class="Element15">
USB_DEVICE_CDC_EVENT_READ_COMPLETE</div>
<p class="Element10">
<i>Application Response</i><strong>: </strong>This event occurs when a read operation scheduled by calling the USB_DEVICE_CDC_Read function has completed. This event does not require the application to respond with any function calls.&nbsp;</p>
<p class="Element10">
<i>Event Specific Data (pData)</i>: The pData member in the event handler will point to the USB_DEVICE_CDC_EVENT_DATA_READ_COMPLETE type.&nbsp;</p>
<p class="Element10">
<i>Likely Follow-up event</i><strong>: </strong>None.&nbsp;</p><div class="Element15">
USB_DEVICE_CDC_EVENT_SERIAL_STATE_NOTIFICATION_COMPLETE</div>
<p class="Element10">
<i>Application Response</i><strong>: </strong>This event occurs when a serial state notification send scheduled by calling the USB_DEVICE_CDC_SerialStateNotificationSend function has completed. This event does not require the application to respond with any function calls.&nbsp;</p>
<p class="Element10">
<i>Event Specific Data (pData)</i>: The pData member in the event handler will point to the USB_DEVICE_CDC_EVENT_DATA_SERIAL_STATE_NOTIFICATION_COMPLETE data type.&nbsp;</p>
<p class="Element10">
<i>Likely Follow-up event</i>:<strong> </strong>None.&nbsp;</p><div class="Element15">
USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_SENT</div>
<p class="Element10">
<i>Application Response</i>:<strong> </strong>This event occurs when the data stage of a control read transfer has completed in response to the USB_DEVICE_ControlSend function (in the USB_DEVICE_CDC_EVENT_GET_LINE_CODING event). The application must acknowledge the handshake stage of the control transfer by calling the USB_DEVICE_ControlStatus function with the USB_DEVICE_CONTROL_STATUS_OK flag.&nbsp;</p>
<p class="Element10">
<i>Event Specific Data (pData)</i>: The pData parameter will be NULL.&nbsp;</p>
<p class="Element10">
<i>Likely Follow-up event</i>:<strong> </strong>None.&nbsp;</p><div class="Element15">
USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_RECEIVED</div>
<p class="Element10">
<i>Application Response</i>:<strong> </strong>This event occurs when the data stage of a control write transfer has completed in response to the USB_DEVICE_ControlReceive function (in the USB_DEVICE_CDC_EVENT_SET_LINE_CODING event).&nbsp;</p>
<p class="Element10">
<i>Event Specific Data (pData)</i>: The pData parameter will be NULL.&nbsp;</p>
<p class="Element10">
<i>Likely Follow-up event</i><strong>: </strong>None.&nbsp;</p><div class="Element15">
CDC Function Driver Event Handling</div>
<p class="Element10">
The following code shows an event handling scheme example. The application always returns from the event handler with a USB_DEVICE_CDC_EVENT_RESPONSE_NONE value. </p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00019');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00019"><pre class="Element12">    <i><span style="color: #008000">// This code example shows all CDC Function Driver possible events</span></i>
    <i><span style="color: #008000">// and a possible scheme for handling these events. In this case</span></i>
    <i><span style="color: #008000">// event responses are not deferred.</span></i>

    uint16_t * breakData;
    USB_DEVICE_HANDLE    usbDeviceHandle;
    USB_CDC_LINE_CODING  lineCoding;
    USB_CDC_CONTROL_LINE_STATE * controlLineStateData

    USB_DEVICE_CDC_EVENT_RESPONSE USBDeviceCDCEventHandler
    (
        USB_DEVICE_CDC_INDEX instanceIndex,
        USB_DEVICE_CDC_EVENT event,
        <strong><span style="color: #000080">void</span></strong> * data,
        uintptr_t userData
    )
    {
        <strong><span style="color: #000080">switch</span></strong>(event)
        {
            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_CDC_EVENT_SET_LINE_CODING:

                <i><span style="color: #008000">// In this case, the application should read the line coding</span></i>
                <i><span style="color: #008000">// data that is sent by the host.</span></i>

                USB_DEVICE_ControlReceive(usbDeviceHandle, &amp;lineCoding,
                                    <strong><span style="color: #000080">sizeof</span></strong>(USB_CDC_LINE_CODING));
                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_CDC_EVENT_GET_LINE_CODING:

                <i><span style="color: #008000">// In this case, the application should send the line coding</span></i>
                <i><span style="color: #008000">// data to the host.</span></i>

                USB_DEVICE_ControlSend(usbDeviceHandle, &amp;lineCoding,
                                    <strong><span style="color: #000080">sizeof</span></strong>(USB_DEVICE_CDC_LINE_CODING));
                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_CDC_EVENT_SET_CONTROL_LINE_STATE:

                <i><span style="color: #008000">// In this case, pData should be interpreted as a</span></i>
                <i><span style="color: #008000">// USB_CDC_CONTROL_LINE_STATE pointer type.  The application</span></i>
                <i><span style="color: #008000">// acknowledges the parameters by calling the</span></i>
                <i><span style="color: #008000">// USB_DEVICE_ControlStatus() function with the</span></i>
                <i><span style="color: #008000">// USB_DEVICE_CONTROL_STATUS_OK option.</span></i>

                controlLineStateData = (USB_CDC_CONTROL_LINE_STATE *)pData;
                USB_DEVICE_ControlStatus(usbDeviceHandle, USB_DEVICE_CONTROL_STATUS_OK);

                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_CDC_EVENT_SEND_BREAK:

                <i><span style="color: #008000">// In this case, pData should be interpreted as a uint16_t</span></i>
                <i><span style="color: #008000">// pointer type to the break duration. The application</span></i>
                <i><span style="color: #008000">// acknowledges the parameters by calling the</span></i>
                <i><span style="color: #008000">// USB_DEVICE_ControlStatus() function with the</span></i>
                <i><span style="color: #008000">// USB_DEVICE_CONTROL_STATUS_OK option.</span></i>

                breakDuration = (USB_DEVICE_CDC_EVENT_DATA_SEND_BREAK *)pData;
                USB_DEVICE_ControlStatus(usbDeviceHandle, USB_DEVICE_CONTROL_STATUS_OK);

                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_SENT:

                <i><span style="color: #008000">// This event indicates the data send request associated with</span></i>
                <i><span style="color: #008000">// the latest USB_DEVICE_ControlSend() function was</span></i>
                <i><span style="color: #008000">// completed.  The application could use this event to track</span></i>
                <i><span style="color: #008000">// the completion of the USB_DEVICE_CDC_EVENT_GET_LINE_CODING</span></i>
                <i><span style="color: #008000">// request.</span></i>

                <strong><span style="color: #000080">break</span></strong>;
            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_CDC_EVENT_CONTROL_TRANSFER_DATA_RECEIVED:

                <i><span style="color: #008000">// This means that the data stage is complete. The data in</span></i>
                <i><span style="color: #008000">// setLineCodingData is valid or data in getLineCodingData was</span></i>
                <i><span style="color: #008000">// sent to the host.  The application can now decide whether it</span></i>
                <i><span style="color: #008000">// supports this data. It is not mandatory to do this in the</span></i>
                <i><span style="color: #008000">// event handler.</span></i>

                USB_DEVICE_ControlStatus(usbDeviceHandle, USB_DEVICE_CONTROL_STATUS_OK);

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_CDC_EVENT_WRITE_COMPLETE:

                <i><span style="color: #008000">// This means USB_DEVICE_CDC_Write() operation completed.</span></i>
                <i><span style="color: #008000">// The pData member will point to a</span></i>
                <i><span style="color: #008000">// USB_DEVICE_CDC_EVENT_DATA_WRITE_COMPLETE type of data.</span></i>

                <strong><span style="color: #000080">break</span></strong>;
            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_CDC_EVENT_READ_COMPLETE:

                <i><span style="color: #008000">// This means USB_DEVICE_CDC_Read() operation completed.</span></i>
                <i><span style="color: #008000">// The pData member will point to a</span></i>
                <i><span style="color: #008000">// USB_DEVICE_CDC_EVENT_DATA_READ_COMPLETE type of data.</span></i>

                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_CDC_EVENT_SERIAL_STATE_NOTIFICATION_COMPLETE:

                <i><span style="color: #008000">// This means USB_DEVICE_CDC_SerialStateNotification() operation</span></i>
                <i><span style="color: #008000">// completed. The pData member will point to a</span></i>
                <i><span style="color: #008000">// USB_DEVICE_CDC_EVENT_DATA_SERIAL_STATE_NOTIFICATION_COMPLETE type of data.</span></i>

                <strong><span style="color: #000080">break</span></strong>;

             <strong><span style="color: #000080">default</span></strong>:
                <strong><span style="color: #000080">break</span></strong>;
         }

        <strong><span style="color: #000080">return</span></strong>(USB_DEVICE_CDC_EVENT_RESPONSE_NONE);
    }</pre></div></div>
<p class="Element10">
Refer to the USB_DEVICE_CDC_EVENT enumeration for more details on each event.</p></div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="00290.html">USB Libraries Help</a> &gt; <a href="00197.html">USB Device Libraries</a> &gt; <a href="00195.html">USB CDC Device Library</a> &gt; <a href="00194.html">Using the Library</a> &gt; <a href="00187.html">How the Library Works</a> &gt; <a href="00184.html">Event Handling</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony USB Stack </div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="00171.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: USB DEVCDC Event Handling Topic Title: Event Handling)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>