<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" data-whc_version="24.1">
    <head><link rel="shortcut icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><link rel="icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="The USB Driver Common Interface definition specifies the functions and their behavior that a USB Driver must implement so that the driver can be used by the MPLAB Harmony USB Host and Device Stack. ..."/><meta name="copyright" content="(C) Copyright 2024"/><meta name="generator" content="DITA-OT"/><title>4.1 Common Interface</title><!--  Generated with Oxygen version 24.1, build number 2022062014.  --><meta name="wh-path2root" content=""/><meta name="wh-toc-id" content="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39-d5029e5405"/><meta name="wh-source-relpath" content="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39.xml"/><meta name="wh-out-relpath" content="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39.html"/>
    <!-- Latest compiled and minified Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/lib/bootstrap/css/bootstrap.min.css"/>
    
    <link rel="stylesheet" href="./oxygen-webhelp/lib/jquery-ui/jquery-ui.min.css"/>
    
    <!-- Template default styles  -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/app/topic-page.css?buildId=2022062014"/>
    
    
    <script src="./oxygen-webhelp/lib/jquery/jquery-3.5.1.min.js"></script>
    
    <script data-main="./oxygen-webhelp/app/topic-page.js" src="./oxygen-webhelp/lib/requirejs/require.js"></script>
<link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/microchip.css?buildId=2022062014"/><link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/notes.css?buildId=2022062014"/>
<script src="mchp-context-help.js"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async="" type="text/javascript"></script>
    <script src="https://assets.adobedtm.com/6a72a357eb48/a636c708c7fe/launch-0b0023397020.min.js"></script><!-- Adobe Analytics -->
</head>

    <body id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            Jump to main content
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="index.html" class=" wh_logo d-none d-sm-block "><img src="oxygen-webhelp\template\resources/images/microchip.png" alt="MPLAB® Harmony 3 USB Library &#xA;    "/></a>
                    <div class=" wh_publication_title "><a href="index.html">MPLAB® Harmony 3 USB Library 
    </a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        </div>
    </div>
</header>
        
        
         
        
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="search.html"><div class="d-flex justify-contents-around"><div class="flex-grow-1"></div><div class="position-relative flex-grow-1"><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" required="required"/><button type="submit" class="wh_search_button" aria-label="Search"><span class="search_input_text">Search</span></button></div><div class="align-self-center flex-grow-1 ml-2"></div></div></form>
            
            <div class="mchp-color-stripe-grid-container">
  <div class="mchp-main-bar mchp-orange-bar"></div>
  <div class="mchp-main-bar mchp-blue-bar"></div>
  <div class="mchp-main-bar mchp-green-bar"></div>
</div>
            
        </div>
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="index.html"><span>Home</span></a></span></li><li><div class="topicref" data-id="GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F"><div class="title"><a href="GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4</ph>
USB Common Driver Interface</a></div></div></li><li class="active"><div class="topicref" data-id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39"><div class="title"><a href="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.1</ph>
Common Interface</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="Collapse sections" title="Collapse sections"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            <div class="row" style="margin-top: -1em;"><div class="col-lg-9 col-md-9 col-sm-12 offset-lg-3 offset-md-3 text-right border-bottom mb-1"><h2 class="text-dark header_title">
    </h2></div></div>
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-D9F90103-F97D-468D-90FC-EA3E186842D9-d5029e11" class="topicref" data-id="GUID-D9F90103-F97D-468D-90FC-EA3E186842D9" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-D9F90103-F97D-468D-90FC-EA3E186842D9-d5029e11-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-D9F90103-F97D-468D-90FC-EA3E186842D9.html" id="GUID-D9F90103-F97D-468D-90FC-EA3E186842D9-d5029e11-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1</ph>
Release Information</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-61902145-0FA6-4DE3-845C-B14852166EAE-d5029e27" class="topicref" data-id="GUID-61902145-0FA6-4DE3-845C-B14852166EAE" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-61902145-0FA6-4DE3-845C-B14852166EAE-d5029e27-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-61902145-0FA6-4DE3-845C-B14852166EAE.html" id="GUID-61902145-0FA6-4DE3-845C-B14852166EAE-d5029e27-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2</ph>
USB Device Libraries</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-B14EBEC0-7590-4740-800B-6CE5FE9AB121-d5029e3093" class="topicref" data-id="GUID-B14EBEC0-7590-4740-800B-6CE5FE9AB121" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-B14EBEC0-7590-4740-800B-6CE5FE9AB121-d5029e3093-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-B14EBEC0-7590-4740-800B-6CE5FE9AB121.html" id="GUID-B14EBEC0-7590-4740-800B-6CE5FE9AB121-d5029e3093-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">3</ph>
USB Host Libraries</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F-d5029e5397" class="topicref" data-id="GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F-d5029e5397-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F.html" id="GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F-d5029e5397-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4</ph>
USB Common Driver Interface</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="true" class="active"><div data-tocid="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39-d5029e5405" class="topicref" data-id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39-d5029e5405-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39.html" id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39-d5029e5405-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.1</ph>
Common Interface</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-DAE7BD2C-129E-4F03-BF5D-3A315C9DEF45-d5029e5413" class="topicref" data-id="GUID-DAE7BD2C-129E-4F03-BF5D-3A315C9DEF45" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-DAE7BD2C-129E-4F03-BF5D-3A315C9DEF45-d5029e5413-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-DAE7BD2C-129E-4F03-BF5D-3A315C9DEF45.html" id="GUID-DAE7BD2C-129E-4F03-BF5D-3A315C9DEF45-d5029e5413-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.1.1</ph>
Driver Host Mode Client Functions</a></div></div></li><li role="treeitem"><div data-tocid="GUID-1B002121-F8DD-4F43-B052-BF0BD1C4CEC6-d5029e5437" class="topicref" data-id="GUID-1B002121-F8DD-4F43-B052-BF0BD1C4CEC6" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-1B002121-F8DD-4F43-B052-BF0BD1C4CEC6.html" id="GUID-1B002121-F8DD-4F43-B052-BF0BD1C4CEC6-d5029e5437-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.1.2</ph>
Driver Device Mode Client Functions</a></div></div></li><li role="treeitem"><div data-tocid="GUID-0F4E88DE-15B9-4CE8-9B09-044A80E81C4D-d5029e5445" class="topicref" data-id="GUID-0F4E88DE-15B9-4CE8-9B09-044A80E81C4D" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-0F4E88DE-15B9-4CE8-9B09-044A80E81C4D.html" id="GUID-0F4E88DE-15B9-4CE8-9B09-044A80E81C4D-d5029e5445-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.1.3</ph>
Driver General Client Functions</a></div></div></li><li role="treeitem"><div data-tocid="GUID-655F3E4F-8C51-4725-9838-73500FD7AF00-d5029e5453" class="topicref" data-id="GUID-655F3E4F-8C51-4725-9838-73500FD7AF00" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-655F3E4F-8C51-4725-9838-73500FD7AF00.html" id="GUID-655F3E4F-8C51-4725-9838-73500FD7AF00-d5029e5453-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.1.4</ph>
Opening the Driver</a></div></div></li><li role="treeitem"><div data-tocid="GUID-364A16EE-4ABA-46E5-91D2-DD954EEEA6E1-d5029e5461" class="topicref" data-id="GUID-364A16EE-4ABA-46E5-91D2-DD954EEEA6E1" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-364A16EE-4ABA-46E5-91D2-DD954EEEA6E1.html" id="GUID-364A16EE-4ABA-46E5-91D2-DD954EEEA6E1-d5029e5461-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.1.5</ph>
USB Driver Host Mode Operation</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-4D46C075-0FAB-49DF-8561-98820CD2536B-d5029e5469" class="topicref" data-id="GUID-4D46C075-0FAB-49DF-8561-98820CD2536B" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-4D46C075-0FAB-49DF-8561-98820CD2536B-d5029e5469-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-4D46C075-0FAB-49DF-8561-98820CD2536B.html" id="GUID-4D46C075-0FAB-49DF-8561-98820CD2536B-d5029e5469-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.1.6</ph>
USB Driver Device Mode Operation</a></div></div></li></ul></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d5029e5501" class="topicref backmatter backmatter_parent" data-id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d5029e5501-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B.html" id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d5029e5501-link">Microchip Information</a></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-9 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        
                        <div class=" wh_topic_content body "><main role="main"><article role="article" aria-labelledby="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-2931669D-E6E5-4FF7-A6CC-24AE6F2E2EEF"><h1 class="- topic/title title topictitle1" id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-2931669D-E6E5-4FF7-A6CC-24AE6F2E2EEF" style="">4.1 Common Interface</h1><div class="- topic/body body"><div class="- topic/p p">The USB Driver Common Interface definition specifies the functions and their behavior that a
      USB Driver must implement so that the driver can be used by the MPLAB Harmony USB Host and
      Device Stack.<div class="- topic/note note notype note_notype" id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-77AB1345-9575-422E-8CF7-5567F6B0A87E" data-ofbid="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-77AB1345-9575-422E-8CF7-5567F6B0A87E"><span class="note__title">Note:</span> The MPLAB Harmony USB Driver for PIC32MX and PIC32MZ devices implements the
        USB Driver Common Interface. <p class="- topic/p p">The USB Driver Common Interface contains functions that are
          grouped as follows:</p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-157AD0C2-EDC5-4C48-A46A-8DFCFCA572C4" data-ofbid="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-157AD0C2-EDC5-4C48-A46A-8DFCFCA572C4"><em class="+ topic/ph hi-d/i ph i">Driver System Functions</em> - These functions are called by MPLAB Harmony to
            initialize and maintain the operational state of the USB Driver. The system functions
            can vary between different PIC32 device USB Drivers. As such, the USB Driver Common
            Interface does not require these functions to be of the same type. These functions are
            not called by the USB Host or Device Stack and therefore are allowed to (and can) vary
            across different PIC32 device USB Drivers. A description of these functions, along with
            a description of how to initialize the USB Driver for Host, Device or Dual Role
            operation, is provided in the specific PIC32 device USB Driver help section (see PIC32MX
            USB Driver and PIC32MZ USB Driver).</li><li class="- topic/li li" id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-69D09528-C98A-4681-A37C-D7194B5C7791" data-ofbid="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-69D09528-C98A-4681-A37C-D7194B5C7791"><em class="+ topic/ph hi-d/i ph i">Driver General Client Functions</em>
            -These functions are called by the USB Host or Device Stack to gain access to the
            driver.</li><li class="- topic/li li" id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-D6F01B83-176E-4E66-BD42-4E5314D21D35" data-ofbid="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-D6F01B83-176E-4E66-BD42-4E5314D21D35"><em class="+ topic/ph hi-d/i ph i">Driver Host Mode Client
              Functions</em> - These functions are called exclusively by the USB Host Stack to
            operate and access the USB as a Host.</li><li class="- topic/li li" id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-7CFE3E99-C324-4C39-96C1-B3A93B50581B" data-ofbid="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-7CFE3E99-C324-4C39-96C1-B3A93B50581B"><em class="+ topic/ph hi-d/i ph i">Driver Device Mode Client
              Functions</em> - These functions are called exclusively by the USB Device Stack to
            operate and access the USB as a Device.</li></ul><p class="- topic/p p">The USB Driver Common Interface is defined in the
            <code class="+ topic/ph pr-d/codeph ph codeph">&lt;install-dir&gt;</code>\<code class="+ topic/ph pr-d/codeph ph codeph">framework\driver\usb\drv_usb.h</code> file.
          This file contains the data types and structures that define the interface. Specifically,
          the DRV_USB_HOST_INTERFACE structure, contained in this file, is the common interface for
          USB Driver Host mode functions. It is a structure of function pointers, pointing to
          functions that define the Driver Host mode Client functions. The following code example
          shows this structure and the function pointer it contains.</p></div></div><pre class="- topic/pre pre"><em class="+ topic/ph hi-d/i ph i">// *****************************************************************************</em>
<em class="+ topic/ph hi-d/i ph i">/* USB Driver Client Functions Interface (For Host mode)

  Summary:
    Group of function pointers to the USB Driver Host mode Client Functions.

  Description:
    This structure is a group of function pointers pointing to the USB Driver
    Host mode Client routines. The USB Driver should export this group of
    functions so that the Host layer can access the driver functionality.

  Remarks:
    None.
*/</em><strong class="+ topic/ph hi-d/b ph b">typedef</strong><strong class="+ topic/ph hi-d/b ph b">struct</strong>
{
    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the driver Open function. This function may be
     * called twice in a Dual Role application, once by the Host Stack and then
     * by the Device Stack */</em>
    DRV_HANDLE (*open)(<strong class="+ topic/ph hi-d/b ph b">const</strong> SYS_MODULE_INDEX drvIndex, <strong class="+ topic/ph hi-d/b ph b">const</strong> DRV_IO_INTENT intent);

    <em class="+ topic/ph hi-d/i ph i">/* This is pointer to the driver Close function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*close)(DRV_HANDLE handle);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the event call back set function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*eventHandlerSet)(DRV_HANDLE handle, uintptr_t hReferenceData,
           DRV_USB_EVENT_CALLBACK eventHandler);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the Host IRP submit function */</em>
    USB_ERROR (*hostIRPSubmit)(DRV_USB_HOST_PIPE_HANDLE pipeHandle, USB_HOST_IRP * irp);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the Host IRP Cancel all function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*hostIRPCancel)(USB_HOST_IRP * irp);

    <em class="+ topic/ph hi-d/i ph i">/* This is pointer to the Host event disable function */</em>
    <strong class="+ topic/ph hi-d/b ph b">bool</strong> (*hostEventsDisable)(DRV_HANDLE handle);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the Host event enable function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*hostEventsEnable)(DRV_HANDLE handle, <strong class="+ topic/ph hi-d/b ph b">bool</strong> eventContext);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the Host pipe setup function */</em>
    DRV_USB_HOST_PIPE_HANDLE (*hostPipeSetup)
    (
        DRV_HANDLE client,
        uint8_t deviceAddress,
        USB_ENDPOINT endpointAndDirection,
        uint8_t hubAddress,
        uint8_t hubPort,
        USB_TRANSFER_TYPE pipeType,
        uint8_t bInterval,
        uint16_t wMaxPacketSize,
        USB_SPEED speed
    );

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the Host Pipe Close function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*hostPipeClose)(DRV_USB_HOST_PIPE_HANDLE pipeHandle);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the Host Root Hub functions */</em>
    DRV_USB_ROOT_HUB_INTERFACE rootHubInterface;

} DRV_USB_HOST_INTERFACE;</pre><p class="- topic/p p">The DRV_USB_DEVICE_INTERFACE structure, contained in this file, is the common interface for
      USB Driver Device mode functions. It is a structure of function pointers, pointer to functions
      that define the Driver Device mode Client functions. The following code example shows this
      structure and the function pointer it contains.</p><pre class="- topic/pre pre"><em class="+ topic/ph hi-d/i ph i">// *****************************************************************************</em>
<em class="+ topic/ph hi-d/i ph i">/* USB Driver Client Functions Interface (For Device Mode)

  Summary:
    Group of function pointers to the USB Driver Device Mode Client Functions.

  Description:
    This structure is a group of function pointers pointing to the USB Driver
    Device Mode Client routines. The USB Driver should export this group of
    functions so that the Device Layer can access the driver functionality.

  Remarks:
    None.
*/</em><strong class="+ topic/ph hi-d/b ph b">typedef</strong><strong class="+ topic/ph hi-d/b ph b">struct</strong>
{
    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the driver Open function */</em>
    DRV_HANDLE (*open)(<strong class="+ topic/ph hi-d/b ph b">const</strong> SYS_MODULE_INDEX drvIndex, <strong class="+ topic/ph hi-d/b ph b">const</strong> DRV_IO_INTENT intent);

    <em class="+ topic/ph hi-d/i ph i">/* This is pointer to the driver Close function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*close)(DRV_HANDLE handle);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the event call back set function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*eventHandlerSet)(DRV_HANDLE handle, uintptr_t hReferenceData,
           DRV_USB_EVENT_CALLBACK eventHandler);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device address set function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*deviceAddressSet)(DRV_HANDLE handle, uint8_t address);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device current speed get function */</em>
    USB_SPEED (*deviceCurrentSpeedGet)(DRV_HANDLE handle);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the SOF Number get function */</em>
    uint16_t (*deviceSOFNumberGet)(DRV_HANDLE handle);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device attach function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*deviceAttach)(DRV_HANDLE handle);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device detach function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*deviceDetach)(DRV_HANDLE handle);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device endpoint enable function */</em>
    USB_ERROR (*deviceEndpointEnable)(DRV_HANDLE handle, USB_ENDPOINT endpoint,
                USB_TRANSFER_TYPE transferType, uint16_t endpointSize);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device endpoint disable function */</em>
    USB_ERROR (*deviceEndpointDisable)(DRV_HANDLE handle, USB_ENDPOINT endpoint);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device endpoint stall function */</em>
    USB_ERROR (*deviceEndpointStall)(DRV_HANDLE handle, USB_ENDPOINT endpoint);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device endpoint stall clear function */</em>
    USB_ERROR (*deviceEndpointStallClear)(DRV_HANDLE handle, USB_ENDPOINT endpoint);

    <em class="+ topic/ph hi-d/i ph i">/* This is pointer to the device endpoint enable status query function */</em>
    <strong class="+ topic/ph hi-d/b ph b">bool</strong> (*deviceEndpointIsEnabled)(DRV_HANDLE handle, USB_ENDPOINT endpoint);

    <em class="+ topic/ph hi-d/i ph i">/* This is pointer to the device endpoint stall status query function */</em>
    <strong class="+ topic/ph hi-d/b ph b">bool</strong> (*deviceEndpointIsStalled)(DRV_HANDLE handle, USB_ENDPOINT endpoint);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device IRP submit function */</em>
    USB_ERROR (*deviceIRPSubmit)(DRV_HANDLE handle, USB_ENDPOINT endpoint,
                USB_DEVICE_IRP * irp);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device IRP Cancel all function */</em>
    USB_ERROR (*deviceIRPCancelAll)(DRV_HANDLE handle, USB_ENDPOINT endpoint);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device remote wakeup start function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*deviceRemoteWakeupStart)(DRV_HANDLE handle);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device remote wakeup stop function */</em>
    <strong class="+ topic/ph hi-d/b ph b">void</strong> (*deviceRemoteWakeupStop)(DRV_HANDLE handle);

    <em class="+ topic/ph hi-d/i ph i">/* This is a pointer to the device Test mode enter function */</em>
    USB_ERROR (*deviceTestModeEnter)(DRV_HANDLE handle, USB_TEST_MODE_SELECTORS testMode);

} DRV_USB_DEVICE_INTERFACE;</pre><div class="- topic/bodydiv bodydiv"><p class="- topic/p p">Both of these structures also contain pointers to General Client functions. The
        specific PIC32 device USB Driver allocates and initializes such a structure. The following
        code example shows how the PIC32MX USB Host mode Driver allocates and initializes the
        DRV_USB_HOST_INTERFACE structure. This code is contained in the
        </p><code class="+ topic/ph pr-d/codeph ph codeph">&lt;install-dir&gt;\framework\driver\usb\usbhs\src\dynamic\drv_usbfs_host.c</code>
      file.</div><pre class="- topic/pre pre"><em class="+ topic/ph hi-d/i ph i">/**********************************************************
 * This structure is a set of pointer to the USBFS driver
 * functions. It is provided to the Host layer as the
 * interface to the driver.
 * *******************************************************/</em>

DRV_USB_HOST_INTERFACE gDrvUSBFSHostInterface =
{
    .open = DRV_USBFS_Open,
    .close = DRV_USBFS_Close,
    .eventHandlerSet = DRV_USBFS_ClientEventCallBackSet,
    .hostIRPSubmit = DRV_USBFS_HOST_IRPSubmit,
    .hostIRPCancel = DRV_USBFS_HOST_IRPCancel,
    .hostPipeSetup = DRV_USBFS_HOST_PipeSetup,
    .hostPipeClose = DRV_USBFS_HOST_PipeClose,
    .hostEventsDisable = DRV_USBFS_HOST_EventsDisable,
    .hostEventsEnable = DRV_USBFS_HOST_EventsEnable,
    .rootHubInterface.rootHubPortInterface.hubPortReset = DRV_USBFS_HOST_ROOT_HUB_PortReset,
    .rootHubInterface.rootHubPortInterface.hubPortSpeedGet =
                                                    DRV_USBFS_HOST_ROOT_HUB_PortSpeedGet,
    .rootHubInterface.rootHubPortInterface.hubPortResetIsComplete =
                                                    DRV_USBFS_HOST_ROOT_HUB_PortResetIsComplete,
    .rootHubInterface.rootHubPortInterface.hubPortSuspend = DRV_USBFS_HOST_ROOT_HUB_PortSuspend,
    .rootHubInterface.rootHubPortInterface.hubPortResume = DRV_USBFS_HOST_ROOT_HUB_PortResume,
    .rootHubInterface.rootHubMaxCurrentGet = DRV_USBFS_HOST_ROOT_HUB_MaximumCurrentGet,
    .rootHubInterface.rootHubPortNumbersGet = DRV_USBFS_HOST_ROOT_HUB_PortNumbersGet,
    .rootHubInterface.rootHubSpeedGet = DRV_USBFS_HOST_ROOT_HUB_BusSpeedGet,
    .rootHubInterface.rootHubInitialize = DRV_USBFS_HOST_ROOT_HUB_Initialize,
    .rootHubInterface.rootHubOperationEnable = DRV_USBFS_HOST_ROOT_HUB_OperationEnable,
    .rootHubInterface.rootHubOperationIsEnabled = DRV_USBFS_HOST_ROOT_HUB_OperationIsEnabled,
};</pre><div class="- topic/bodydiv bodydiv"><p class="- topic/p p">Similarly, the PIC32MX USB Device mode Driver allocates and initializes the
        DRV_USB_DEVICE_INTERFACE structure. This can be reviewed in the
        </p><code class="+ topic/ph pr-d/codeph ph codeph">&lt;install-dir&gt;\framework\driver\usb\usbhs\src\dynamic\drv_usbfs_device.c</code>
      file.</div><pre class="- topic/pre pre"><em class="+ topic/ph hi-d/i ph i">/*****************************************************
 * This structure is a pointer to a set of USB Driver
 * Device mode functions. This set is exported to the
 * Device Layer when the Device Layer must use the
 * PIC32MX USB Controller.
 ******************************************************/</em>

DRV_USB_DEVICE_INTERFACE gDrvUSBFSDeviceInterface =
{
    .open = DRV_USBFS_Open,
    .close = DRV_USBFS_Close,
    .eventHandlerSet = DRV_USBFS_ClientEventCallBackSet,
    .deviceAddressSet = DRV_USBFS_DEVICE_AddressSet,
    .deviceCurrentSpeedGet = DRV_USBFS_DEVICE_CurrentSpeedGet,
    .deviceSOFNumberGet = DRV_USBFS_DEVICE_SOFNumberGet,
    .deviceAttach = DRV_USBFS_DEVICE_Attach,
    .deviceDetach = DRV_USBFS_DEVICE_Detach,
    .deviceEndpointEnable = DRV_USBFS_DEVICE_EndpointEnable,
    .deviceEndpointDisable = DRV_USBFS_DEVICE_EndpointDisable,
    .deviceEndpointStall = DRV_USBFS_DEVICE_EndpointStall,
    .deviceEndpointStallClear = DRV_USBFS_DEVICE_EndpointStallClear,
    .deviceEndpointIsEnabled = DRV_USBFS_DEVICE_EndpointIsEnabled,
    .deviceEndpointIsStalled = DRV_USBFS_DEVICE_EndpointIsStalled,
    .deviceIRPSubmit = DRV_USBFS_DEVICE_IRPSubmit,
    .deviceIRPCancelAll = DRV_USBFS_DEVICE_IRPCancelAll,
    .deviceRemoteWakeupStop = DRV_USBFS_DEVICE_RemoteWakeupStop,
    .deviceRemoteWakeupStart = DRV_USBFS_DEVICE_RemoteWakeupStart,
    .deviceTestModeEnter = NULL
};</pre><p class="- topic/p p">A pointer to the DRV_USB_HOST_INTERFACE structure is passed to the USB Host Stack as part of
      USB Host Stack initialization. The following code example shows how this is done.</p><pre class="- topic/pre pre"><em class="+ topic/ph hi-d/i ph i">/********************************************************************************</em>
* This is a table of the USB Host mode drivers that <strong class="+ topic/ph hi-d/b ph b">this</strong> application will
 * support. Also contained in the driver index. In <strong class="+ topic/ph hi-d/b ph b">this</strong> example, the
 * application will want to use instance 0 of the PIC32MX USB Full-Speed driver.
 * *****************************************************************************/
<strong class="+ topic/ph hi-d/b ph b">const</strong> USB_HOST_HCD hcdTable =
{
    .drvIndex = DRV_USBFS_INDEX_0,
    .hcdInterface = DRV_USBFS_HOST_INTERFACE
};

<em class="+ topic/ph hi-d/i ph i">/* Here the pointer to the USB Driver Common Interface is provided to the USB
 * Host Layer via the hostControllerDrivers member of the Host Layer
 * Initialization data structure. */</em>
<strong class="+ topic/ph hi-d/b ph b">const</strong> USB_HOST_INIT usbHostInitData =
{
    .nTPLEntries = 1 ,
    .tplList = (USB_HOST_TPL_ENTRY *)USBTPList,
    .hostControllerDrivers = (USB_HOST_HCD *)&amp;hcdTable

};</pre><p class="- topic/p p">A pointer to the DRV_USB_DEVICE_INTERFACE structure is passed to the USB Device Stack as part
      of the USB Device Stack initialization. The Host Stack and Device Stack then access the driver
      functions through the function pointers contained in these structures. </p><p class="- topic/p p">The Driver General Client, Host mode and Device mode Client functions are described in this
      section. Any references to a USB Driver Client in the following sections, implies the client
      is a USB Host Stack and/or the USB Device Stack.</p><section class="- topic/section section" id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-259377D1-A4BB-42B2-AF8F-7F789BB7E44E" data-ofbid="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-259377D1-A4BB-42B2-AF8F-7F789BB7E44E"><h2 class="- topic/title title sectiontitle">Topics</h2>
      
      <div class="- topic/p p">
        <div class="table-container"><table class="- topic/table table" id="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-91B264AB-05FA-496C-876F-CD9BDAB24DEB" data-ofbid="GUID-7B57189D-AB41-4208-8FBA-0C1C2C9DAE39__GUID-91B264AB-05FA-496C-876F-CD9BDAB24DEB" data-cols="2"><caption></caption><colgroup><col style="width:35%"/><col style="width:65%"/></colgroup><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0">Name </td><td class="- topic/entry entry colsep-0 rowsep-0">Description </td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0"><a class="- topic/xref xref" href="GUID-DAE7BD2C-129E-4F03-BF5D-3A315C9DEF45.html">Driver
                    Host Mode Client Functions</a></td><td class="- topic/entry entry colsep-0 rowsep-0">Provides information on the Host mode Client functions for the USB Driver.
                </td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0"><a class="- topic/xref xref" href="GUID-1B002121-F8DD-4F43-B052-BF0BD1C4CEC6.html">Driver
                    Device Mode Client Functions</a></td><td class="- topic/entry entry colsep-0 rowsep-0">Provides information on the USB Driver Device mode Client functions. </td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0"><a class="- topic/xref xref" href="GUID-0F4E88DE-15B9-4CE8-9B09-044A80E81C4D.html">Driver
                    General Client Functions</a></td><td class="- topic/entry entry colsep-0 rowsep-0">Provides information on the General Client functions for the USB Driver.
                </td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0"><a class="- topic/xref xref" href="GUID-655F3E4F-8C51-4725-9838-73500FD7AF00.html">Opening
                    the Driver</a></td><td class="- topic/entry entry colsep-0 rowsep-0">Provides information and examples for opening the driver. </td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0"><a class="- topic/xref xref" href="GUID-364A16EE-4ABA-46E5-91D2-DD954EEEA6E1.html">USB
                    Driver Host Mode Operation</a></td><td class="- topic/entry entry colsep-0 rowsep-0">Provides information on Host mode operation. </td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0"><a class="- topic/xref xref" href="GUID-4D46C075-0FAB-49DF-8561-98820CD2536B.html">USB
                    Driver Device Mode Operation</a>
                </td><td class="- topic/entry entry colsep-0 rowsep-0">Provides information on Device mode operation. </td></tr></tbody></table></div>
      </div>
    </section></div></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
    <div class="footer">
  <div class="mchp-wh-footer">
    <div class="mchp-footer">
      <div class="mchp-footer-tier1">
        <div class="spacer"></div>
        <div class="mchp-footer-container">
          <div class="mchp-footer-links mchp-social-media-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.facebook.com/pages/Microchip-Technology-Inc/20320981741" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Facebook" src="oxygen-webhelp/template/resources/images/201016-corp-facebook.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.linkedin.com/company/microchip-technology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip LinkedIn" src="oxygen-webhelp/template/resources/images/201016-corp-linkedin.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://twitter.com/MicrochipTech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Twitter" src="oxygen-webhelp/template/resources/images/201016-corp-twitter.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.youtube.com/user/MicrochipTechnology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip YouTube" src="oxygen-webhelp/template/resources/images/201016-corp-youtube.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.instagram.com/microchiptechnologyinc/" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Instagram" src="oxygen-webhelp/template/resources/images/201016-corp-instagram.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.weibo.com/microchiptech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Weibo" src="oxygen-webhelp/template/resources/images/201016-corp-weibo.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.microchip.com/en-us/about/blog" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Blog" src="oxygen-webhelp/template/resources/images/201016-corp-blog.png"/>
                </a>
              </div>
            </div>
          </div>
          <div class="mchp-footer-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://www.microchip.com/about-us/contact-us" class="mchp-link__link">Contact</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information" class="mchp-link__link">Legal</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/privacy-policy" class="mchp-link__link">Privacy Policy</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/microchip-cookie-statement" class="mchp-link__link">Cookies</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://careers.microchip.com/" class="mchp-link__link">Careers</a>
                  <span class="mchp-link__separator"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="mchp-footer-newsletter">
            <div class="cmp-text">
              <p>Stay on the leading edge with our blog</p>
            </div>
            <div class="mchp-button-wrapper">
              <a role="button" href="https://www.microchip.com/en-us/about/blog" class="mchp-button mchp-button-regular solid">
                <span class="mchp-button__span">MicroSolutions</span>
              </a>
            </div>
          </div>
        </div>
        <div class="graphic">
          <img src="oxygen-webhelp/template/resources/images/footer-graphic.png"/>
        </div>
      </div>
      <div class="mchp-footer-tier2">
        <p class="mchp-copyright">© Copyright 1998-2022 Microchip Technology Inc. All rights reserved.</p>
      </div>
    </div>
  </div>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-19"></script>
  <script>
    window.dataLayer = window.dataLayer || [];  
    function gtag(){dataLayer.push(arguments);}  
    gtag('js', new Date());   
    gtag('config', 'UA-2724382-19');
  </script>
  
  <script type="text/javascript">_satellite.pageBottom();</script><!-- Adobe Analytics -->
  <script type="text/javascript" src="mchp-js/prepend.js"></script><!-- Package for viewing PDFs on mobile devices -->
  
</div>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
       
        </body>
</html>