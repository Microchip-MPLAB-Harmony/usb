<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" data-whc_version="24.1">
    <head><link rel="shortcut icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><link rel="icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Registering a Audio 2.0 Function Driver Callback Function Registering a Audio 2.0 Function Driver Callback Function While creating a USB Audio 2.0 Device application, an event handler must be ..."/><meta name="copyright" content="(C) Copyright 2024"/><meta name="generator" content="DITA-OT"/><title>2.4.3.2 Event Handling</title><!--  Generated with Oxygen version 24.1, build number 2022062014.  --><meta name="wh-path2root" content=""/><meta name="wh-toc-id" content="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE-d5059e1299"/><meta name="wh-source-relpath" content="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE.xml"/><meta name="wh-out-relpath" content="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE.html"/>
    <!-- Latest compiled and minified Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/lib/bootstrap/css/bootstrap.min.css"/>
    
    <link rel="stylesheet" href="./oxygen-webhelp/lib/jquery-ui/jquery-ui.min.css"/>
    
    <!-- Template default styles  -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/app/topic-page.css?buildId=2022062014"/>
    
    
    <script src="./oxygen-webhelp/lib/jquery/jquery-3.5.1.min.js"></script>
    
    <script data-main="./oxygen-webhelp/app/topic-page.js" src="./oxygen-webhelp/lib/requirejs/require.js"></script>
<link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/microchip.css?buildId=2022062014"/><link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/notes.css?buildId=2022062014"/>
<script src="mchp-context-help.js"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async="" type="text/javascript"></script>
    <script src="https://assets.adobedtm.com/6a72a357eb48/a636c708c7fe/launch-0b0023397020.min.js"></script><!-- Adobe Analytics -->
</head>

    <body id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            Jump to main content
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="index.html" class=" wh_logo d-none d-sm-block "><img src="oxygen-webhelp\template\resources/images/microchip.png" alt="MPLAB® Harmony 3 USB Library &#xA;    "/></a>
                    <div class=" wh_publication_title "><a href="index.html">MPLAB® Harmony 3 USB Library 
    </a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        </div>
    </div>
</header>
        
        
         
        
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="search.html"><div class="d-flex justify-contents-around"><div class="flex-grow-1"></div><div class="position-relative flex-grow-1"><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" required="required"/><button type="submit" class="wh_search_button" aria-label="Search"><span class="search_input_text">Search</span></button></div><div class="align-self-center flex-grow-1 ml-2"></div></div></form>
            
            <div class="mchp-color-stripe-grid-container">
  <div class="mchp-main-bar mchp-orange-bar"></div>
  <div class="mchp-main-bar mchp-blue-bar"></div>
  <div class="mchp-main-bar mchp-green-bar"></div>
</div>
            
        </div>
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="index.html"><span>Home</span></a></span></li><li><div class="topicref" data-id="GUID-61902145-0FA6-4DE3-845C-B14852166EAE"><div class="title"><a href="GUID-61902145-0FA6-4DE3-845C-B14852166EAE.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2</ph>
USB Device Libraries</a></div></div></li><li><div class="topicref" data-id="GUID-A95B3616-C0C4-4675-B25C-0117818DF55A"><div class="title"><a href="GUID-A95B3616-C0C4-4675-B25C-0117818DF55A.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4</ph>
USB Audio 2.0 Device Library</a></div></div></li><li><div class="topicref" data-id="GUID-48E6E666-2D07-4AF0-98BF-21FF7F3CC019"><div class="title"><a href="GUID-48E6E666-2D07-4AF0-98BF-21FF7F3CC019.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4.3</ph>
How the Library Works</a></div></div></li><li class="active"><div class="topicref" data-id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE"><div class="title"><a href="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4.3.2</ph>
Event Handling</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="Collapse sections" title="Collapse sections"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            <div class="row" style="margin-top: -1em;"><div class="col-lg-7 col-md-7 col-sm-12 offset-lg-3 offset-md-3 text-right border-bottom mb-1"><h2 class="text-dark header_title">
    </h2></div></div>
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-D9F90103-F97D-468D-90FC-EA3E186842D9-d5059e11" class="topicref" data-id="GUID-D9F90103-F97D-468D-90FC-EA3E186842D9" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-D9F90103-F97D-468D-90FC-EA3E186842D9-d5059e11-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-D9F90103-F97D-468D-90FC-EA3E186842D9.html" id="GUID-D9F90103-F97D-468D-90FC-EA3E186842D9-d5059e11-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1</ph>
Release Information</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="GUID-61902145-0FA6-4DE3-845C-B14852166EAE-d5059e27" class="topicref" data-id="GUID-61902145-0FA6-4DE3-845C-B14852166EAE" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-61902145-0FA6-4DE3-845C-B14852166EAE-d5059e27-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-61902145-0FA6-4DE3-845C-B14852166EAE.html" id="GUID-61902145-0FA6-4DE3-845C-B14852166EAE-d5059e27-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2</ph>
USB Device Libraries</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-11BEDBBA-7CB2-44C2-9A3A-BAF21121881C-d5059e35" class="topicref" data-id="GUID-11BEDBBA-7CB2-44C2-9A3A-BAF21121881C" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-11BEDBBA-7CB2-44C2-9A3A-BAF21121881C-d5059e35-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-11BEDBBA-7CB2-44C2-9A3A-BAF21121881C.html" id="GUID-11BEDBBA-7CB2-44C2-9A3A-BAF21121881C-d5059e35-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.1</ph>
USB Device Library - Getting Started</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-E31828BD-445D-4B5C-A518-308C752ED467-d5059e75" class="topicref" data-id="GUID-E31828BD-445D-4B5C-A518-308C752ED467" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-E31828BD-445D-4B5C-A518-308C752ED467-d5059e75-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-E31828BD-445D-4B5C-A518-308C752ED467.html" id="GUID-E31828BD-445D-4B5C-A518-308C752ED467-d5059e75-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.2</ph>
USB Device Layer Library</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-79B0676D-688A-498D-86C5-0386E1CECD24-d5059e841" class="topicref" data-id="GUID-79B0676D-688A-498D-86C5-0386E1CECD24" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-79B0676D-688A-498D-86C5-0386E1CECD24-d5059e841-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-79B0676D-688A-498D-86C5-0386E1CECD24.html" id="GUID-79B0676D-688A-498D-86C5-0386E1CECD24-d5059e841-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.3</ph>
USB Audio 1.0 Device Library</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="GUID-A95B3616-C0C4-4675-B25C-0117818DF55A-d5059e1243" class="topicref" data-id="GUID-A95B3616-C0C4-4675-B25C-0117818DF55A" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-A95B3616-C0C4-4675-B25C-0117818DF55A-d5059e1243-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-A95B3616-C0C4-4675-B25C-0117818DF55A.html" id="GUID-A95B3616-C0C4-4675-B25C-0117818DF55A-d5059e1243-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4</ph>
USB Audio 2.0 Device Library</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="GUID-89BA69E5-54BC-419A-A79D-A17881CBE438-d5059e1251" class="topicref" data-id="GUID-89BA69E5-54BC-419A-A79D-A17881CBE438" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-89BA69E5-54BC-419A-A79D-A17881CBE438.html" id="GUID-89BA69E5-54BC-419A-A79D-A17881CBE438-d5059e1251-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4.1</ph>
Introduction</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-51FD97A5-27B2-446C-8627-6C45271E80CB-d5059e1259" class="topicref" data-id="GUID-51FD97A5-27B2-446C-8627-6C45271E80CB" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-51FD97A5-27B2-446C-8627-6C45271E80CB-d5059e1259-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-51FD97A5-27B2-446C-8627-6C45271E80CB.html" id="GUID-51FD97A5-27B2-446C-8627-6C45271E80CB-d5059e1259-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4.2</ph>
Using the Library</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="GUID-48E6E666-2D07-4AF0-98BF-21FF7F3CC019-d5059e1283" class="topicref" data-id="GUID-48E6E666-2D07-4AF0-98BF-21FF7F3CC019" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-48E6E666-2D07-4AF0-98BF-21FF7F3CC019-d5059e1283-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-48E6E666-2D07-4AF0-98BF-21FF7F3CC019.html" id="GUID-48E6E666-2D07-4AF0-98BF-21FF7F3CC019-d5059e1283-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4.3</ph>
How the Library Works</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="GUID-56CC5C1C-D4F8-4EF6-B52D-829A34037610-d5059e1291" class="topicref" data-id="GUID-56CC5C1C-D4F8-4EF6-B52D-829A34037610" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-56CC5C1C-D4F8-4EF6-B52D-829A34037610.html" id="GUID-56CC5C1C-D4F8-4EF6-B52D-829A34037610-d5059e1291-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4.3.1</ph>
Initializing the Library</a></div></div></li><li role="treeitem" class="active"><div data-tocid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE-d5059e1299" class="topicref" data-id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE.html" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE-d5059e1299-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4.3.2</ph>
Event Handling</a></div></div></li><li role="treeitem"><div data-tocid="GUID-AFEF301E-8D78-40A9-AD56-7E047113B3B6-d5059e1307" class="topicref" data-id="GUID-AFEF301E-8D78-40A9-AD56-7E047113B3B6" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-AFEF301E-8D78-40A9-AD56-7E047113B3B6.html" id="GUID-AFEF301E-8D78-40A9-AD56-7E047113B3B6-d5059e1307-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4.3.3</ph>
Transferring Data</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-626FC551-2434-4762-B4A6-3BB9EFFFF859-d5059e1315" class="topicref" data-id="GUID-626FC551-2434-4762-B4A6-3BB9EFFFF859" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-626FC551-2434-4762-B4A6-3BB9EFFFF859-d5059e1315-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-626FC551-2434-4762-B4A6-3BB9EFFFF859.html" id="GUID-626FC551-2434-4762-B4A6-3BB9EFFFF859-d5059e1315-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4.4</ph>
Configuring the Library</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-9D6BBB18-66F8-4585-86F9-4EC0D75D960E-d5059e1363" class="topicref" data-id="GUID-9D6BBB18-66F8-4585-86F9-4EC0D75D960E" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-9D6BBB18-66F8-4585-86F9-4EC0D75D960E-d5059e1363-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-9D6BBB18-66F8-4585-86F9-4EC0D75D960E.html" id="GUID-9D6BBB18-66F8-4585-86F9-4EC0D75D960E-d5059e1363-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4.5</ph>
Library Interface</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-A2ED1C83-94A4-476A-8DEB-4B072DC69557-d5059e1508" class="topicref" data-id="GUID-A2ED1C83-94A4-476A-8DEB-4B072DC69557" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-A2ED1C83-94A4-476A-8DEB-4B072DC69557-d5059e1508-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-A2ED1C83-94A4-476A-8DEB-4B072DC69557.html" id="GUID-A2ED1C83-94A4-476A-8DEB-4B072DC69557-d5059e1508-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.4.6</ph>
Files</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-3908AD9D-1B49-4753-BC38-DED35835C53D-d5059e1532" class="topicref" data-id="GUID-3908AD9D-1B49-4753-BC38-DED35835C53D" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-3908AD9D-1B49-4753-BC38-DED35835C53D-d5059e1532-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-3908AD9D-1B49-4753-BC38-DED35835C53D.html" id="GUID-3908AD9D-1B49-4753-BC38-DED35835C53D-d5059e1532-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.5</ph>
USB CDC Device Library</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-613273BE-7CAE-4009-8D41-414550E0F0DE-d5059e2096" class="topicref" data-id="GUID-613273BE-7CAE-4009-8D41-414550E0F0DE" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-613273BE-7CAE-4009-8D41-414550E0F0DE-d5059e2096-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-613273BE-7CAE-4009-8D41-414550E0F0DE.html" id="GUID-613273BE-7CAE-4009-8D41-414550E0F0DE-d5059e2096-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.6</ph>
USB HID Device Library</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-307732A6-6933-419F-82A5-10A831C61589-d5059e2474" class="topicref" data-id="GUID-307732A6-6933-419F-82A5-10A831C61589" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-307732A6-6933-419F-82A5-10A831C61589-d5059e2474-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-307732A6-6933-419F-82A5-10A831C61589.html" id="GUID-307732A6-6933-419F-82A5-10A831C61589-d5059e2474-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.7</ph>
Generic USB Device Library</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-CC2E109D-AC7E-40AA-977A-31768A94691F-d5059e2594" class="topicref" data-id="GUID-CC2E109D-AC7E-40AA-977A-31768A94691F" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-CC2E109D-AC7E-40AA-977A-31768A94691F-d5059e2594-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-CC2E109D-AC7E-40AA-977A-31768A94691F.html" id="GUID-CC2E109D-AC7E-40AA-977A-31768A94691F-d5059e2594-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.8</ph>
USB MSD Device Library</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-D225D104-1D70-4E1D-9E88-40C8E685F725-d5059e2754" class="topicref" data-id="GUID-D225D104-1D70-4E1D-9E88-40C8E685F725" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-D225D104-1D70-4E1D-9E88-40C8E685F725-d5059e2754-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-D225D104-1D70-4E1D-9E88-40C8E685F725.html" id="GUID-D225D104-1D70-4E1D-9E88-40C8E685F725-d5059e2754-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2.9</ph>
USB Device Printer Library</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-B14EBEC0-7590-4740-800B-6CE5FE9AB121-d5059e3093" class="topicref" data-id="GUID-B14EBEC0-7590-4740-800B-6CE5FE9AB121" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-B14EBEC0-7590-4740-800B-6CE5FE9AB121-d5059e3093-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-B14EBEC0-7590-4740-800B-6CE5FE9AB121.html" id="GUID-B14EBEC0-7590-4740-800B-6CE5FE9AB121-d5059e3093-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">3</ph>
USB Host Libraries</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F-d5059e5397" class="topicref" data-id="GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F-d5059e5397-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F.html" id="GUID-6AFB98D6-0272-4DED-BBAB-39EECD8DDB5F-d5059e5397-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4</ph>
USB Common Driver Interface</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d5059e5501" class="topicref backmatter backmatter_parent" data-id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d5059e5501-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B.html" id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d5059e5501-link">Microchip Information</a></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article role="article" aria-labelledby="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-03FC8F47-319E-41DD-B958-F082CD7FE8A8">
<h1 class="- topic/title title topictitle1" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-03FC8F47-319E-41DD-B958-F082CD7FE8A8" style="">2.4.3.2 Event Handling</h1>
    <div class="- topic/body body">
        <section class="- topic/section section" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_ZQ2_SRK_J1C" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_ZQ2_SRK_J1C"><h2 class="- topic/title title sectiontitle">Registering a Audio 2.0 Function Driver Callback Function</h2>
            
            <p class="- topic/p p">Registering a Audio 2.0 Function Driver Callback Function</p>
            <p class="- topic/p p">While creating a USB Audio 2.0 Device application, an event handler must be
                registered with the Device Layer (the Device Layer Event Handler) and every Audio
                2.0 Function Driver instance (Audio 2.0 Function Driver Event Handler). The
                application needs to register the event handler with the Audio 2.0 Function
                Driver:</p>
            <ul class="- topic/ul ul" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__UL_LX5_QRK_J1C" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__UL_LX5_QRK_J1C">
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-F8254CAA-A2D0-4434-A965-698D7F55BBD0" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-F8254CAA-A2D0-4434-A965-698D7F55BBD0">For receiving Audio 2.0 Control Requests from Host like Volume Control, Mute
                    Control, etc.</li>
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-CCA7C406-583C-47D1-A6D8-B9BC5DEAA3D5" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-CCA7C406-583C-47D1-A6D8-B9BC5DEAA3D5">For handling other events from
                    USB Audio 2.0 Device Driver (e.g., Data Write Complete or Data Read
                    Complete).</li>
            </ul>
            <p class="- topic/p p">The event handler should be registered before the USB device layer_acknowledges the
                SET CONFIGURATION request from the USB Host. To ensure this, the callback function
                should be set in the USB_DEVICE_EVENT_CONFIGURED event that is generated by the
                device_layer. The following code example shows how this can be done.</p>
            <pre class="- topic/pre pre" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__PRE_MX5_QRK_J1C" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__PRE_MX5_QRK_J1C"><em class="+ topic/ph hi-d/i ph i">/* This a sample Application Device Layer Event Handler
 * Note how the USB Audio 2.0 Device Driver callback function
 * USB_DEVICE_AUDIO_2_0_EventHandlerSet()
 * is registered in the USB_DEVICE_EVENT_CONFIGURED event.  */</em>
<strong class="+ topic/ph hi-d/b ph b">void</strong> APP_UsbDeviceEventCallBack( USB_DEVICE_EVENT event, <strong class="+ topic/ph hi-d/b ph b">void</strong> * pEventData, uintptr_t context )
{
    uint8_t * configuredEventData;
    <strong class="+ topic/ph hi-d/b ph b">switch</strong>( event )
    {
        <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_EVENT_RESET:
            <strong class="+ topic/ph hi-d/b ph b">break</strong>;
        <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_EVENT_DECONFIGURED:
            <em class="+ topic/ph hi-d/i ph i">// USB device is reset or device is de-configured.</em>
            <em class="+ topic/ph hi-d/i ph i">// This means that USB device layer is about to de-initialize</em>
            <em class="+ topic/ph hi-d/i ph i">// all function drivers. So close handles to previously opened</em>
            <em class="+ topic/ph hi-d/i ph i">// function drivers.</em>
            <strong class="+ topic/ph hi-d/b ph b">break</strong>;

        <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_EVENT_CONFIGURED:
            <em class="+ topic/ph hi-d/i ph i">/* check the configuration */</em>
            <em class="+ topic/ph hi-d/i ph i">/* Initialize the Application */</em>
            configuredEventData = pEventData;
            <strong class="+ topic/ph hi-d/b ph b">if</strong>(*configuredEventData == 1)
            {
                USB_DEVICE_AUDIO_V2_EventHandlerSet
                (
                    0,
                    APP_USBDeviceAudioEventHandler ,
                    (uintptr_t)NULL
                );
                <em class="+ topic/ph hi-d/i ph i">/* mark that set configuration is complete */</em>
                appData.isConfigured = <strong class="+ topic/ph hi-d/b ph b">true</strong>;
            }
            <strong class="+ topic/ph hi-d/b ph b">break</strong>;

        <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_EVENT_SUSPENDED:
            <strong class="+ topic/ph hi-d/b ph b">break</strong>;

        <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_EVENT_POWER_DETECTED:
            <em class="+ topic/ph hi-d/i ph i">/* Attach the device */</em>
            USB_DEVICE_Attach (appData.usbDevHandle);
            <strong class="+ topic/ph hi-d/b ph b">break</strong>;

        <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_EVENT_POWER_REMOVED:
                <em class="+ topic/ph hi-d/i ph i">/* VBUS is not available. We can detach the device */</em>
                USB_DEVICE_Detach(appData.usbDevHandle);
                <strong class="+ topic/ph hi-d/b ph b">break</strong>;

        <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_EVENT_RESUMED:
        <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_EVENT_ERROR:
        <strong class="+ topic/ph hi-d/b ph b">default</strong>:
            <strong class="+ topic/ph hi-d/b ph b">break</strong>;
    }
}</pre>
        </section>
        <section class="- topic/section section" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_QDR_1SK_J1C" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_QDR_1SK_J1C"><h2 class="- topic/title title sectiontitle">Event Handling</h2>
            
            <p class="- topic/p p">The Audio 2.0 Function Driver provides events to the application through the event
                handler function registered by the application. These events indicate:</p>
            <ul class="- topic/ul ul" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__UL_NX5_QRK_J1C" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__UL_NX5_QRK_J1C">
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-81E55AE9-A91B-4960-8C4C-1F9D98ACCEA0" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-81E55AE9-A91B-4960-8C4C-1F9D98ACCEA0">Completion of a read or a write data transfer</li>
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-1FD15BD8-B532-4A6C-989F-B1F793DF7963" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-1FD15BD8-B532-4A6C-989F-B1F793DF7963">Audio 2.0 Control Interface requests</li>
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-31E2C91C-B372-4872-8B35-FC56AECD0B86" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-31E2C91C-B372-4872-8B35-FC56AECD0B86">Completion of data and the status stages of Audio 2.0 Control Interface related
                    control transfer</li>
            </ul>
            <p class="- topic/p p">The Audio 2.0 Control Interface Request events and the related control transfer
                events typically require the application to respond with the Device Layer Control
                Transfer routines to complete the control transfer. Based on the generated event,
                the application may be required to:</p>
            <ul class="- topic/ul ul" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__UL_OX5_QRK_J1C" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__UL_OX5_QRK_J1C">
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-9C92344A-73E4-4144-9ADE-A8ECCB81FDF7" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-9C92344A-73E4-4144-9ADE-A8ECCB81FDF7">Respond with a <a class="- topic/xref xref" href="GUID-85F7260B-F498-4865-A1A6-0FB2C1EA5AD0.html">USB_DEVICE_ControlSend</a> function, which is completes the data stage
                    of a Control Read Transfer.</li>
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-13DAD4A5-08B5-49CA-8268-43C8BAAEA35F" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-13DAD4A5-08B5-49CA-8268-43C8BAAEA35F">Respond with a <a class="- topic/xref xref" href="GUID-33991F1C-C31B-413E-BD6B-29A870E556B5.html">USB_DEVICE_ControlReceive</a> function, which provisions the data stage
                    of a Control Write Transfer.</li>
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-B71704C9-83B8-4983-AEE3-B784E229F057" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-B71704C9-83B8-4983-AEE3-B784E229F057">Respond with a <a class="- topic/xref xref" href="GUID-34243A48-7930-4EBD-9E40-AF31631C2B9F.html">USB_DEVICE_ControlStatus</a> function, which completes the
                    handshake stage of the Control Transfer. The application can either STALL or
                    Acknowledge the handshake stage through the <a class="- topic/xref xref" href="GUID-34243A48-7930-4EBD-9E40-AF31631C2B9F.html">USB_DEVICE_ControlStatus</a> function.</li>
            </ul>
            <p class="- topic/p p">The following table shows the Audio 2.0 Function Driver Control Transfer related
                events and the required application control transfer actions.</p>
            <div class="table-container"><table class="- topic/table table" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__TABLE_PX5_QRK_J1C" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__TABLE_PX5_QRK_J1C" data-cols="2"><caption></caption><colgroup><col style="width:26%"/><col style="width:74%"/></colgroup><tbody class="- topic/tbody tbody">
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">Audio 2.0 Function Driver Control Transfer Event </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0">Required Application Action </td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_DEVICE_AUDIO_V2_CUR_ENTITY_SETTINGS_RECEIVED </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0">Identify the control type using the associated event data. If a
                                data stage is expected, use the <a class="- topic/xref xref" href="GUID-33991F1C-C31B-413E-BD6B-29A870E556B5.html">USB_DEVICE_ControlReceive</a> function to receive expected
                                data. If a data stage is not required or if the request is not
                                supported, use the <a class="- topic/xref xref" href="GUID-34243A48-7930-4EBD-9E40-AF31631C2B9F.html">USB_DEVICE_ControlStatus</a> function to Acknowledge or
                                Stall the request. </td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_DEVICE_AUDIO_V2_RANGE_ENTITY_SETTINGS_RECEIVED </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0">Identify the control type using the associated event data. If a
                                data stage is expected, use the <a class="- topic/xref xref" href="GUID-33991F1C-C31B-413E-BD6B-29A870E556B5.html">USB_DEVICE_ControlReceive</a> function to receive expected
                                data. If a data stage is not required or if the request is not
                                supported, use the <a class="- topic/xref xref" href="GUID-34243A48-7930-4EBD-9E40-AF31631C2B9F.html">USB_DEVICE_ControlStatus</a> function to Acknowledge or
                                Stall the request. </td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_DEVICE_AUDIO_V2_EVENT_CONTROL_TRANSFER_DATA_RECEIVED </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0">Acknowledge or stall using the <a class="- topic/xref xref" href="GUID-34243A48-7930-4EBD-9E40-AF31631C2B9F.html">USB_DEVICE_ControlStatus</a> function. </td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_DEVICE_AUDIO_V2_EVENT_CONTROL_TRANSFER_DATA_SENT </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0">Action not required. </td>
                        </tr>
                    </tbody></table></div>
            <p class="- topic/p p">The application must analyze the wIndex field of the event data (received with the
                control transfer event) to identify the entity that is being addressed. The
                application must be aware of all entities included in the application and their IDs.
                Once identified, the application can then type cast the event data to entity type
                the specific control request type. For example, if the Host sends a control request
                to set the clock source for the Audio 2.0 device, the following occurs in this
                order:</p>
            <ol class="- topic/ol ol" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__OL_QX5_QRK_J1C" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__OL_QX5_QRK_J1C">
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-A68716A1-C887-4D1D-8D2E-E2F700C0B77A" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-A68716A1-C887-4D1D-8D2E-E2F700C0B77A">The Audio 2.0 Function Driver will generate a
                    USB_DEVICE_AUDIO_V2_CUR_ENTITY_SETTINGS_RECEIVED event.</li>
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-F8F6AE6A-B6D7-4760-BCC5-2EFC242963D6" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-F8F6AE6A-B6D7-4760-BCC5-2EFC242963D6">The application must type cast the event data to a
                    USB_AUDIO_V2_CONTROL_INTERFACE_REQUEST type and check the entityID field.</li>
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-A269190A-0784-4339-8DCC-14CB39CF76B0" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-A269190A-0784-4339-8DCC-14CB39CF76B0">The entityID field will be identified by the application as a Clock Source.</li>
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-D4A78C02-01A7-428D-9EB8-58513A1812FF" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-D4A78C02-01A7-428D-9EB8-58513A1812FF">The application must now type cast the event data type as a
                    USB_AUDIO_V2_CLOCKSOURCE_CONTROL_REQUEST data type and check the controlSelector
                    field.</li>
                <li class="- topic/li li" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-B6695FE1-56B3-4271-A535-CA2A8A57512E" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__GUID-B6695FE1-56B3-4271-A535-CA2A8A57512E">If the controlSelector field is AUDIO_V2_CS_SAM_FREQ_CONTROL, the application
                    can then call the <a class="- topic/xref xref" href="GUID-33991F1C-C31B-413E-BD6B-29A870E556B5.html">USB_DEVICE_ControlReceive</a> function to receive the clock
                    source.</li>
            </ol>
            <p class="- topic/p p">Based on the type of event, the application should analyze the event data parameter
                of the event handler. This data member should be type cast to an event specific data
                type. The following table shows the event and the data type to use while type
                casting. Note that the event data member is not required for all events.</p>
            <div class="table-container"><table class="- topic/table table" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__TABLE_RX5_QRK_J1C" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__TABLE_RX5_QRK_J1C" data-cols="2"><caption></caption><colgroup><col style="width:59%"/><col style="width:41%"/></colgroup><tbody class="- topic/tbody tbody">
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">Audio 2.0 Function Driver Event </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0">Related Event Data Type </td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_DEVICE_AUDIO_V2_CUR_ENTITY_SETTINGS_RECEIVED </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_AUDIO_V2_CONTROL_INTERFACE_REQUEST* </td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_DEVICE_AUDIO_V2_RANGE_ENTITY_SETTINGS_RECEIVED </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_AUDIO_V2_CONTROL_INTERFACE_REQUEST* </td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_DEVICE_AUDIO_V2_EVENT_CONTROL_TRANSFER_DATA_RECEIVED </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0">NULL </td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_DEVICE_AUDIO_V2_EVENT_CONTROL_TRANSFER_DATA_SENT </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0">NULL </td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_DEVICE_AUDIO_V2_EVENT_INTERFACE_SETTING_CHANGED </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0"><a class="- topic/xref xref" href="GUID-1BD030C0-77A0-4453-A713-825A02BD5438.html">USB_DEVICE_AUDIO_V2_EVENT_DATA_SET_ALTERNATE_INTERFACE</a> *
                            </td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_DEVICE_AUDIO_V2_EVENT_READ_COMPLETE </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0"><a class="- topic/xref xref" href="GUID-1A11CC93-7677-478B-B3E0-5C8E5AEA049F.html">USB_DEVICE_AUDIO_V2_EVENT_DATA_READ_COMPLETE</a>
                                * </td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0">USB_DEVICE_AUDIO_V2_EVENT_WRITE_COMPLETE </td>
                            <td class="- topic/entry entry colsep-0 rowsep-0"><a class="- topic/xref xref" href="GUID-3CFBEC17-77C6-4CF9-979D-58C3488DFBDD.html">USB_DEVICE_AUDIO_V2_EVENT_DATA_WRITE_COMPLETE
                                </a>* </td>
                        </tr>
                    </tbody></table></div>
        </section>
        <section class="- topic/section section" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_AVQ_NSK_J1C" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_AVQ_NSK_J1C"><h2 class="- topic/title title sectiontitle">Handling Audio Control Requests:</h2>
            
            <div class="- topic/p p">When the Audio 2.0 Function Driver receives an Audio 2.0 Class Specific Control
                Transfer Request, it passes this control transfer to the application as a Audio 2.0
                Function Driverevent. The following code example shows how to handle an Audio 2.0
                Control
                request.<pre class="- topic/pre pre" id="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__PRE_SX5_QRK_J1C" data-ofbid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__PRE_SX5_QRK_J1C"><strong class="+ topic/ph hi-d/b ph b">void</strong> APP_USBDeviceAudioEventHandler
(
    USB_DEVICE_AUDIO_V2_INDEX iAudio ,
    USB_DEVICE_AUDIO_V2_EVENT event ,
    <strong class="+ topic/ph hi-d/b ph b">void</strong> * pData,
    uintptr_t context
)
{
    USB_DEVICE_AUDIO_V2_EVENT_DATA_SET_ALTERNATE_INTERFACE * interfaceInfo;
    USB_DEVICE_AUDIO_V2_EVENT_DATA_READ_COMPLETE * readEventData;
    USB_DEVICE_AUDIO_V2_EVENT_DATA_WRITE_COMPLETE * writeEventData;
   USB_AUDIO_V2_CONTROL_INTERFACE_REQUEST* controlRequest;
    <strong class="+ topic/ph hi-d/b ph b">if</strong> ( iAudio == 0 )
    {
        <strong class="+ topic/ph hi-d/b ph b">switch</strong> (event)
        {
            <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_AUDIO_V2_EVENT_READ_COMPLETE:
                readEventData = (USB_DEVICE_AUDIO_V2_EVENT_DATA_READ_COMPLETE *)pData;
                <em class="+ topic/ph hi-d/i ph i">//We have received an audio frame from the Host.</em><em class="+ topic/ph hi-d/i ph i">//Now send this audio frame to Audio Codec for Playback.</em><strong class="+ topic/ph hi-d/b ph b">break</strong>;

            <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_AUDIO_V2_EVENT_WRITE_COMPLETE:

            <strong class="+ topic/ph hi-d/b ph b">break</strong>;

            <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_AUDIO_V2_EVENT_INTERFACE_SETTING_CHANGED:
                <em class="+ topic/ph hi-d/i ph i">//We have received a request from USB host to change the Interface-</em><em class="+ topic/ph hi-d/i ph i">//Alternate setting.</em>
                interfaceInfo = (USB_DEVICE_AUDIO_V2_EVENT_DATA_SET_ALTERNATE_INTERFACE *)pData;
                appData.activeInterfaceAlternateSetting = interfaceInfo-&gt;interfaceAlternateSetting;
                appData.state = APP_USB_INTERFACE_ALTERNATE_SETTING_RCVD;

            <strong class="+ topic/ph hi-d/b ph b">break</strong>;
            <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_AUDIO_V2_CUR_ENTITY_SETTINGS_RECEIVED:
                controlRequest = (USB_AUDIO_V2_CONTROL_INTERFACE_REQUEST*) setupPkt;
    USB_AUDIO_V2_CLOCKSOURCE_CONTROL_REQUEST* clockSourceRequest;

        <strong class="+ topic/ph hi-d/b ph b">switch</strong>(controlRequest-&gt;entityID)
        {
       <strong class="+ topic/ph hi-d/b ph b">case</strong> APP_ID_CLOCK_SOURCE:
          clockSourceRequest = (USB_AUDIO_V2_CLOCKSOURCE_CONTROL_REQUEST*) controlRequest;
                     <strong class="+ topic/ph hi-d/b ph b">switch</strong>(clockSourceRequest-&gt;controlSelector)
                    {
                          <strong class="+ topic/ph hi-d/b ph b">case</strong> AUDIO_V2_CS_SAM_FREQ_CONTROL:
                         {
                        <strong class="+ topic/ph hi-d/b ph b">if</strong> ((controlRequest-&gt;bmRequestType &amp; 0x80) == 0)
                        {
                            <em class="+ topic/ph hi-d/i ph i">//A control write transfer received from Host. Now receive data from Host.</em>
                           USB_DEVICE_ControlReceive(appData.usbDevHandle, (<strong class="+ topic/ph hi-d/b ph b">void</strong> *) &amp;(appData.clockSource), 4 );
                           appData.currentAudioControl = APP_USB_AUDIO_CLOCKSOURCE_CONTROL;
                                   }
                              <strong class="+ topic/ph hi-d/b ph b">else</strong>
                              {
                        <em class="+ topic/ph hi-d/i ph i">/*Handle Get request*/</em>
                        USB_DEVICE_ControlSend(appData.usbDevHandle, (<strong class="+ topic/ph hi-d/b ph b">void</strong> *)&amp;(appData.clockSource), 4 );
                        appData.currentAudioControl = APP_USB_CONTROL_NONE;
                                }
                       }

}
                <strong class="+ topic/ph hi-d/b ph b">break</strong>;

            <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_AUDIO_V2_RANGE_ENTITY_SETTINGS_RECEIVED:

                <strong class="+ topic/ph hi-d/b ph b">break</strong>;

            <strong class="+ topic/ph hi-d/b ph b">case</strong> USB_DEVICE_AUDIO_V2_EVENT_CONTROL_TRANSFER_DATA_RECEIVED:
                USB_DEVICE_ControlStatus(appData.usbDevHandle, USB_DEVICE_CONTROL_STATUS_OK );
                <strong class="+ topic/ph hi-d/b ph b">switch</strong> (appData.currentAudioControl)
                {
                    <strong class="+ topic/ph hi-d/b ph b">case</strong> APP_USB_AUDIO_MUTE_CONTROL:
                    {
                        appData.state = APP_MUTE_AUDIO_PLAYBACK;
                        appData.currentAudioControl = APP_USB_CONTROL_NONE;
                    }
                    <strong class="+ topic/ph hi-d/b ph b">break</strong>;
                    <strong class="+ topic/ph hi-d/b ph b">case</strong> APP_USB_AUDIO_CLOCKSOURCE_CONTROL:
                    {
                        <em class="+ topic/ph hi-d/i ph i">// Handle Clock Source Control here.</em>
                        appData.state = APP_CLOCKSOURCE_SET;
                        appData.currentAudioControl = APP_USB_CONTROL_NONE;
                    }
                    <strong class="+ topic/ph hi-d/b ph b">break</strong>;
                    <strong class="+ topic/ph hi-d/b ph b">case</strong> APP_USB_AUDIO_CLOCKSELECT_CONTROL:
                    {
                        <em class="+ topic/ph hi-d/i ph i">// Handle Clock Source Control here.</em>
                        appData.currentAudioControl = APP_USB_CONTROL_NONE;

                    }
                    <strong class="+ topic/ph hi-d/b ph b">break</strong>;
                }
            <strong class="+ topic/ph hi-d/b ph b">break</strong>;
            <strong class="+ topic/ph hi-d/b ph b">case</strong>  USB_DEVICE_AUDIO_V2_EVENT_CONTROL_TRANSFER_DATA_SENT:
            <strong class="+ topic/ph hi-d/b ph b">break</strong>;
            <strong class="+ topic/ph hi-d/b ph b">default</strong>:
                SYS_ASSERT ( <strong class="+ topic/ph hi-d/b ph b">false</strong> , "Invalid callback" );
            <strong class="+ topic/ph hi-d/b ph b">break</strong>;
        } <em class="+ topic/ph hi-d/i ph i">//end of switch ( callback )</em>
    }<em class="+ topic/ph hi-d/i ph i">//end of if  if ( iAudio == 0 )</em>
}<em class="+ topic/ph hi-d/i ph i">//end of function APP_AudioEventCallback</em></pre></div>
        </section>
    </div>
</article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">On this page</div><ul><li class="section-item"><div class="section-title"><a href="#GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_ZQ2_SRK_J1C" data-tocid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_ZQ2_SRK_J1C">Registering a Audio 2.0 Function Driver Callback Function</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_QDR_1SK_J1C" data-tocid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_QDR_1SK_J1C">Event Handling</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_AVQ_NSK_J1C" data-tocid="GUID-0E7C284A-C230-400E-BDCA-7612D44E07CE__SECTION_AVQ_NSK_J1C">Handling Audio Control Requests:</a></div></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
    <div class="footer">
  <div class="mchp-wh-footer">
    <div class="mchp-footer">
      <div class="mchp-footer-tier1">
        <div class="spacer"></div>
        <div class="mchp-footer-container">
          <div class="mchp-footer-links mchp-social-media-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.facebook.com/pages/Microchip-Technology-Inc/20320981741" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Facebook" src="oxygen-webhelp/template/resources/images/201016-corp-facebook.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.linkedin.com/company/microchip-technology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip LinkedIn" src="oxygen-webhelp/template/resources/images/201016-corp-linkedin.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://twitter.com/MicrochipTech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Twitter" src="oxygen-webhelp/template/resources/images/201016-corp-twitter.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.youtube.com/user/MicrochipTechnology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip YouTube" src="oxygen-webhelp/template/resources/images/201016-corp-youtube.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.instagram.com/microchiptechnologyinc/" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Instagram" src="oxygen-webhelp/template/resources/images/201016-corp-instagram.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.weibo.com/microchiptech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Weibo" src="oxygen-webhelp/template/resources/images/201016-corp-weibo.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.microchip.com/en-us/about/blog" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Blog" src="oxygen-webhelp/template/resources/images/201016-corp-blog.png"/>
                </a>
              </div>
            </div>
          </div>
          <div class="mchp-footer-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://www.microchip.com/about-us/contact-us" class="mchp-link__link">Contact</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information" class="mchp-link__link">Legal</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/privacy-policy" class="mchp-link__link">Privacy Policy</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/microchip-cookie-statement" class="mchp-link__link">Cookies</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://careers.microchip.com/" class="mchp-link__link">Careers</a>
                  <span class="mchp-link__separator"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="mchp-footer-newsletter">
            <div class="cmp-text">
              <p>Stay on the leading edge with our blog</p>
            </div>
            <div class="mchp-button-wrapper">
              <a role="button" href="https://www.microchip.com/en-us/about/blog" class="mchp-button mchp-button-regular solid">
                <span class="mchp-button__span">MicroSolutions</span>
              </a>
            </div>
          </div>
        </div>
        <div class="graphic">
          <img src="oxygen-webhelp/template/resources/images/footer-graphic.png"/>
        </div>
      </div>
      <div class="mchp-footer-tier2">
        <p class="mchp-copyright">© Copyright 1998-2022 Microchip Technology Inc. All rights reserved.</p>
      </div>
    </div>
  </div>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-19"></script>
  <script>
    window.dataLayer = window.dataLayer || [];  
    function gtag(){dataLayer.push(arguments);}  
    gtag('js', new Date());   
    gtag('config', 'UA-2724382-19');
  </script>
  
  <script type="text/javascript">_satellite.pageBottom();</script><!-- Adobe Analytics -->
  <script type="text/javascript" src="mchp-js/prepend.js"></script><!-- Package for viewing PDFs on mobile devices -->
  
</div>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
       
        </body>
</html>