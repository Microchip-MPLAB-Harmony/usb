<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Event Handling</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="00290.html">USB Libraries Help</a> &gt; <a href="00197.html">USB Device Libraries</a> &gt; <a href="00126.html">USB Audio 1.0 Device Library</a> &gt; <a href="00111.html">Using the Library</a> &gt; <a href="00106.html">How the Library Works</a> &gt; <a href="00104.html">Event Handling</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony USB Stack </div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="00171.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="00100.html">Previous</a> | <a href="00106.html">Up</a> | <a href="00110.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: USB AUDDEV V1_0 Event Handling Topic Title: Event Handling)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
Event Handling</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<div class="Element15">
Registering a Audio 1.0 Function Driver Callback Function</div>
<p class="Element10">
While creating a USB Audio 1.0 Device application, an event handler must be registered with the Device Layer (the Device Layer Event Handler) and every Audio 1.0 Function Driver instance (Audio 1.0 Function Driver Event Handler). The application needs to register the event handler with the Audio 1.0 Function Driver:</p>
<ul class="Element630">
<li class="Element600">For receiving Audio Control Requests from Host like Volume Control, Mute Control, etc.</li>
<li class="Element600">For handling other events from USB Audio 1.0 Device Driver (e.g., Data Write Complete or Data Read Complete)</li>
</ul><p class="Element10">
The event handler should be registered before the USB device layer<span style="color: #FFFFFF">_</span>acknowledges the SET CONFIGURATION request from the USB Host. To ensure this, the callback function should be set in the USB_DEVICE_EVENT_CONFIGURED event that is generated by the device<span style="color: #FFFFFF">_</span>layer. The following code example shows how this can be done. </p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00012');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00012"><pre class="Element12"><i><span style="color: #008000">/* This a sample Application Device Layer Event Handler
 * Note how the USB Audio 1.0 Device Driver callback function
 * USB_DEVICE_AUDIO_EventHandlerSet()
 * is registered in the USB_DEVICE_EVENT_CONFIGURED event.  */</span></i>

<strong><span style="color: #000080">void</span></strong> APP_USBDeviceEventHandler( USB_DEVICE_EVENT event,
                                <strong><span style="color: #000080">void</span></strong> * pEventData, uintptr_t context )
{
    <strong><span style="color: #000080">switch</span></strong> ( event )
    {
        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_RESET:
        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_DECONFIGURED:

            <i><span style="color: #008000">// USB device is reset or device is deconfigured.</span></i>
            <i><span style="color: #008000">// This means that USB device layer is about to deinitialize</span></i>
            <i><span style="color: #008000">// all function drivers.</span></i>

            <strong><span style="color: #000080">break</span></strong>;

        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_CONFIGURED:

            <i><span style="color: #008000">/* check the configuration */</span></i>
            <strong><span style="color: #000080">if</span></strong> ( ((USB_DEVICE_EVENT_DATA_CONFIGURED *)
                  (eventData))-&gt;configurationValue == 1)
            {

                USB_DEVICE_AUDIO_EventHandlerSet
                     ( USB_DEVICE_AUDIO_INDEX_0,
                       APP_USBDeviceAudioEventHandler ,
                       (uintptr_t)NULL);

                <i><span style="color: #008000">/* mark that set configuration is complete */</span></i>
                appData.isConfigured = <strong><span style="color: #000080">true</span></strong>;

            }
            <strong><span style="color: #000080">break</span></strong>;

        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_SUSPENDED:

            <strong><span style="color: #000080">break</span></strong>;

        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_RESUMED:
        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_POWER_DETECTED:
        <i><span style="color: #008000">/* VBUS has been detected */</span></i>
        USB_DEVICE_Attach(appData.usbDeviceHandle);
    <strong><span style="color: #000080">break</span></strong>;
        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_POWER_REMOVED:
        <i><span style="color: #008000">/*VBUS is not available anymore. */</span></i>
        USB_DEVICE_Detach(appData.usbDeviceHandle);
    <strong><span style="color: #000080">break</span></strong>;
        <strong><span style="color: #000080">case</span></strong> USB_DEVICE_EVENT_ERROR:
        <strong><span style="color: #000080">default</span></strong>:
            <strong><span style="color: #000080">break</span></strong>;
    }
}</pre></div></div>
<div class="Element15">
Event Handling</div>
<p class="Element10">
The Audio 1.0 Function Driver provides events to the application through the event handler function registered by the application. These events indicate:</p>
<ul class="Element630">
<li class="Element600">Completion of a read or a write data transfer</li>
<li class="Element600">Audio Control Interface requests</li>
<li class="Element600">Completion of data and the status stages of Audio Control Interface related control transfer</li>
</ul><p class="Element10">
The Audio Control Interface Request events and the related control transfer events typically require the application to respond with the Device Layer Control Transfer routines to complete the control transfer. Based on the generated event, the application may be required to:</p>
<ul class="Element630">
<li class="Element600">Respond with a USB_DEVICE_ControlSend function, which is completes the data stage of a Control Read Transfer</li>
<li class="Element600">Respond with a USB_DEVICE_ControlReceive function, which provisions the data stage of a Control Write Transfer</li>
<li class="Element600">Respond with a USB_DEVICE_ControlStatus function, which completes the handshake stage of the Control Transfer. The application can either STALL or Acknowledge the handshake stage through the USB_DEVICE_ControlStatus function.</li>
</ul><p class="Element10">
The following table shows the CDC Function Driver Control Transfer related events and the required application control transfer actions. </p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table1">
<tr>
<td class="Element65" valign="top" width="38%">
<div class="Element66">
Audio 1.0 Function Driver Control Transfer Event&nbsp;</div></td><td class="Element65" valign="top" width="62%">
<div class="Element66">
Required Application Action&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="38%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_SET_CUR<br>USB_DEVICE_AUDIO_EVENT_CONTROL_SET_MIN<br>USB_DEVICE_AUDIO_EVENT_CONTROL_SET_MAX<br>USB_DEVICE_AUDIO_EVENT_CONTROL_SET_RES<br>USB_DEVICE_AUDIO_EVENT_CONTROL_SET_MEM&nbsp;</div></td><td class="Element67" valign="top" width="62%">
<div class="Element68">
Identify the control type using the associated event data. If a data stage is expected, use the USB_DEVICE_ControlReceive function to receive expected data. If a data stage is not required or if the request is not supported, use the USB_DEVICE_ControlStatus function to Acknowledge or Stall the request.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="38%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_GET_CUR<br>USB_DEVICE_AUDIO_EVENT_CONTROL_GET_MIN<br>USB_DEVICE_AUDIO_EVENT_CONTROL_GET_MAX<br>USB_DEVICE_AUDIO_EVENT_CONTROL_GET_RES<br>USB_DEVICE_AUDIO_EVENT_CONTROL_GET_MEM&nbsp;</div></td><td class="Element67" valign="top" width="62%">
<div class="Element68">
Identify the control type using the associated event data. Use the USB_DEVICE_ControlSend function to send the expected data. If the request is not supported, use the USB_DEVICE_ControlStatus function to Stall the request.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="38%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ENTITY_GET_STAT&nbsp;</div></td><td class="Element67" valign="top" width="62%">
<div class="Element68">
Identify the entity type using the associated event data. Use the USB_DEVICE_ControlSend function to send the expected data. If the request is not supported, use the USB_DEVICE_ControlStatus function to Stall the request.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="38%">
<div class="Element68">
USB_DEVICE_AUDIO_CONTROL_TRANSFER_DATA_RECEIVED&nbsp;</div></td><td class="Element67" valign="top" width="62%">
<div class="Element68">
Acknowledge or stall using the USB_DEVICE_ControlStatus function.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="38%">
<div class="Element68">
USB_DEVICE_AUDIO_CONTROL_TRANSFER_DATA_SENT&nbsp;</div></td><td class="Element67" valign="top" width="62%">
<div class="Element68">
Action not required.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="38%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_TRANSFER_UNKNOWN&nbsp;</div></td><td class="Element67" valign="top" width="62%">
<div class="Element68">
Interpret the setup packet and use the Device layer Control transfer functions to complete the transfer.&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
The application must analyze the wIndex field of the event data (received with the control transfer event) to identify the entity that is being addressed. The application must be aware of all entities included in the application and their IDs. Once identified, the application can then type cast the event data to entity type the specific control request type. For example, if the Host sends a control request to set the volume of the Audio device, the following occurs in this order:</p>
<ol class="Element630">
<li value="1" class="Element600">The Audio 1.0 Function Driver will generate a USB_DEVICE_AUDIO_EVENT_CONTROL_SET_CUR event.</li>
<li value="2" class="Element600">The application must type cast the event data to a USB_DEVICE_AUDIO_EVENT_DATA_CONTROL_SET_CUR type and check the entityID field.</li>
<li value="3" class="Element600">The entityID field will be identified by the application as a Feature Unit.</li>
<li value="4" class="Element600">The application must now type cast the event data type as a USB_AUDIO_FEATURE_UNIT_CONTROL_REQUEST data type and check the controlSelector field.</li>
<li value="5" class="Element600">If the controlSelector field is a USB_AUDIO_VOLUME_CONTROL, the application can then call the USB_DEVICE_AUDIO_ControlReceive function to receive the new volume settings.</li>
</ol><p class="Element10">
Based on the type of event, the application should analyze the event data parameter of the event handler. This data member should be type cast to an event specific data type. The following table shows the event and the data type to use while type casting. Note that the event data member is not required for all events </p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table1">
<tr>
<td class="Element65" valign="top" width="50%">
<div class="Element66">
Audio 1.0 Function Driver Event&nbsp;</div></td><td class="Element65" valign="top" width="50%">
<div class="Element66">
Related Event Data Type&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_SET_CUR&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_DATA_CONTROL_SET_CUR *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_SET_MIN&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ DATA_CONTROL_SET_MIN *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_SET_MAX&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ DATA_CONTROL_SET_MAX *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_SET_RES&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ DATA_CONTROL_SET_RES *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_SET_MEM&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ DATA_CONTROL_SET_MEM *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_GET_CUR&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ DATA_CONTROL_GET_CUR *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_GET_MIN&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ DATA_CONTROL_GET_MIN *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_GET_MAX&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ DATA_CONTROL_GET_MAX *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_GET_RES&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_GET_RES&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_GET_MEM&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ DATA_CONTROL_GET_MEM *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ENTITY_GET_STAT&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ DATA_ENTITY_GET_STAT *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_CONTROL_TRANSFER_DATA_RECEIVED&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
NULL&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_CONTROL_TRANSFER_DATA_SENT&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
NULL&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_CONTROL_TRANSFER_UNKNOWN&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_SETUP_PACKET *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_WRITE_COMPLETE&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_DATA_WRITE_COMPLETE *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_READ_COMPLETE&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ DATA_READ_COMPLETE *&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_INTERFACE_SETTING_CHANGED&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
USB_DEVICE_AUDIO_EVENT_ DATA_INTERFACE_SETTING_CHANGED *&nbsp;</div></td></tr></table></div></div>
<div class="Element15">
Handling Audio Control Requests:</div>
<p class="Element10">
When the Audio 1.0 Function Driver receives an Audio Class Specific Control Transfer Request, it passes this control transfer to the application as a Audio 1.0 Function Driver event. The following code example shows how to handle an Audio Control request. </p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00013');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00013"><pre class="Element12"><i><span style="color: #008000">// This code example shows handling Audio Control requests. The following code</span></i>
<i><span style="color: #008000">// handles a Mute request (both SET and GET) received from a USB Host.</span></i>

<strong><span style="color: #000080">void</span></strong> APP_USBDeviceAudioEventHandler
(
    USB_DEVICE_AUDIO_INDEX iAudio ,
    USB_DEVICE_AUDIO_EVENT event ,
    <strong><span style="color: #000080">void</span></strong> * pData,
    uintptr_t context
)
{
    USB_DEVICE_AUDIO_EVENT_DATA_INTERFACE_SETTING_CHANGED *interfaceInfo;
    USB_DEVICE_AUDIO_EVENT_DATA_READ_COMPLETE *readEventData;
    uint8_t entityID;
    uint8_t controlSelector;
    <strong><span style="color: #000080">if</span></strong> ( iAudio == 0 )
    {
        <strong><span style="color: #000080">switch</span></strong> (event)
        {
            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_INTERFACE_SETTING_CHANGED:

                <i><span style="color: #008000">/* We have received a request from USB host to change the
                 * Interface-Alternate setting. The application should be aware
                 * of the association between alternate settings and the device
                 * features to be enabled.*/</span></i>

                interfaceInfo = (USB_DEVICE_AUDIO_EVENT_DATA_INTERFACE_SETTING_CHANGED *)pData;
                appData.activeInterfaceAlternateSetting = interfaceInfo-&gt;interfaceAlternateSetting;
                appData.state = APP_USB_INTERFACE_ALTERNATE_SETTING_RCVD;
                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_READ_COMPLETE:
                <i><span style="color: #008000">/* We have received an audio frame from the Host.
                   Now send this audio frame to Audio Codec for Playback. */</span></i>
                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_WRITE_COMPLETE:
                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_CONTROL_SET_CUR:

                <i><span style="color: #008000">/* This is an example of handling Audio control request. In this
                 * case the control request is targeted to the Mute Control in
                 * a feature unit entity. This event indicates that the current
                 * value needs to be set. */</span></i>

                entityID = ((USB_AUDIO_CONTROL_INTERFACE_REQUEST*)pData)-&gt;entityID;
                <strong><span style="color: #000080">if</span></strong> (entityID == APP_ID_FEATURE_UNIT)
                {
                    controlSelector = ((USB_AUDIO_FEATURE_UNIT_CONTROL_REQUEST*)pData)-&gt;controlSelector;
                    <strong><span style="color: #000080">if</span></strong> (controlSelector == USB_AUDIO_MUTE_CONTROL)
                    {
                        <i><span style="color: #008000">/* It is confirmed that this request is targeted to the
                         * mute control. We schedule a control transfer receive
                         * to get data from the host. */</span></i>

                        USB_DEVICE_ControlReceive(appData.usbDevHandle, (<strong><span style="color: #000080">void</span></strong> *) &amp;(appData.dacMute), 1 );
                        appData.currentAudioControl = APP_USB_AUDIO_MUTE_CONTROL;
                    }
                }
                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_CONTROL_GET_CUR:

                <i><span style="color: #008000">/* This event occurs when the host is requesting a current
                 * status of control */</span></i>

                entityID = ((USB_AUDIO_CONTROL_INTERFACE_REQUEST*)pData)-&gt;entityID;
                <strong><span style="color: #000080">if</span></strong> (entityID == APP_ID_FEATURE_UNIT)
                {
                    controlSelector = ((USB_AUDIO_FEATURE_UNIT_CONTROL_REQUEST*)pData)-&gt;controlSelector;
                    <strong><span style="color: #000080">if</span></strong> (controlSelector == USB_AUDIO_MUTE_CONTROL)
                    {
                        <i><span style="color: #008000">/* Use the control send function to send the status of
                         * the control to the host */</span></i>
                        USB_DEVICE_ControlSend(appData.usbDevHandle, (<strong><span style="color: #000080">void</span></strong> *)&amp;(appData.dacMute), 1 );
                    }
                }
                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_CONTROL_SET_MIN:
            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_CONTROL_GET_MIN:
            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_CONTROL_SET_MAX:
            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_CONTROL_GET_MAX:
            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_CONTROL_SET_RES:
            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_CONTROL_GET_RES:
            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_ENTITY_GET_MEM:

                <i><span style="color: #008000">/* In this example, all of these control requests are not
                 * supported. So these are stalled. */</span></i>
                USB_DEVICE_ControlStatus (appData.usbDevHandle, USB_DEVICE_CONTROL_STATUS_ERROR);
                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong> USB_DEVICE_AUDIO_EVENT_CONTROL_TRANSFER_DATA_RECEIVED:

                <i><span style="color: #008000">/* This event occurs when data has been received in a control
                 * transfer */</span></i>

                USB_DEVICE_ControlStatus(appData.usbDevHandle, USB_DEVICE_CONTROL_STATUS_OK );
                <strong><span style="color: #000080">if</span></strong> (appData.currentAudioControl == APP_USB_AUDIO_MUTE_CONTROL)
                {
                    appData.state = APP_MUTE_AUDIO_PLAYBACK;
                    appData.currentAudioControl = APP_USB_CONTROL_NONE;
                }
                <strong><span style="color: #000080">break</span></strong>;

            <strong><span style="color: #000080">case</span></strong>  USB_DEVICE_AUDIO_EVENT_CONTROL_TRANSFER_DATA_SENT:
                <strong><span style="color: #000080">break</span></strong>;
            <strong><span style="color: #000080">default</span></strong>:
                <strong><span style="color: #000080">break</span></strong>;
        }
    }
}</pre></div></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="00290.html">USB Libraries Help</a> &gt; <a href="00197.html">USB Device Libraries</a> &gt; <a href="00126.html">USB Audio 1.0 Device Library</a> &gt; <a href="00111.html">Using the Library</a> &gt; <a href="00106.html">How the Library Works</a> &gt; <a href="00104.html">Event Handling</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony USB Stack </div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="00171.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: USB AUDDEV V1_0 Event Handling Topic Title: Event Handling)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>